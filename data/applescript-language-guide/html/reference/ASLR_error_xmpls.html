<!DOCTYPE html>
<html lang="en">
<head>

    <title>Working with Errors</title>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
    <meta charset="utf-8">
    <meta id="book-resource-type" name="book-resource-type" content="Guide">
    <meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/TP40000983">
    <meta id="document-version" name="document-version" content="5.2.0">
    <meta id="build" name="build" content="c1e4c7a89af8f899a21cfa81fc33ba42" />
    <meta id="chapterId" name="chapterId" content="TP40000983-CH221">
    <meta id="date" name="date" content="2016-01-25">
    <meta id="description" name="description" content="Defines the AppleScript scripting language. Includes many brief sample scripts.">
    <meta id="book-title" name="book-title" content="AppleScript Language Guide">
    <meta id="book-root" name="book-root" content="../">
    <meta id="book-json" name="book-json" content="../book.json">
    <meta id="devcenter" name="devcenter" content="Mac Dev Center">
    <meta id="devcenter-url" name="devcenter-url" content="http://developer.apple.com/devcenter/mac">
    <meta id="reflib" name="reflib" content="Documentation Archive">
    <meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Topic/Languages & Utilities/Other Languages}">
    
    
    <meta id="copyright" name="copyright" content="Copyright 2018 Apple Inc. All Rights Reserved.">
    <meta id="xcode-display" name="xcode-display" content="render">
    <meta id="IndexTitle" name="IndexTitle" content="AppleScript Language Guide: Working with Errors">
    <meta id="resources-uri" name="resources-uri" content="../../../../../Resources/1282">
    <link id="book-index-page" rel="Start" title="AppleScript Language Guide" type="text/html" href="../index.html">
    <link id="next-page" rel="Next" type="text/html" href="../conceptual/ASLR_raw_data.html">
    <link id="previous-page" rel="Prev" type="text/html" href="ASLR_error_codes.html">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1282/CSS/screen.css">
    
    <!-- xcode_css -->
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1282/CSS/feedback.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta id="platforms" name="platforms" content="">
</head>    
<body><a name="//apple_ref/doc/uid/TP40000983-CH221" title="Working with Errors"></a>
    <div id="_omniture_top">
    <!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
    <script type="text/javascript">
    /* RSID: */
    var s_account="awdappledeveloper"
    </script>

    <script type="text/javascript" src="https://developer.apple.com/assets/metrics/scripts/analytics.js"></script>
    <script type="text/javascript">
    s.channel="www.documentationarchive.developer"

    /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
    var s_code=s.t();if(s_code)document.write(s_code)</script>
    <!-- End SiteCatalyst code version: H.8. -->
    </div>

    <div id="adcHeader" class="hideOnPrint hideInXcode">
        <div id='ssi_Header' class="hideInXcode unified">
            <a id="ssi_LibraryTitle" href='../../../../../navigation/'>Documentation Archive</a>
            <a id="ssi_AppleDeveloperConnection" href='https://developer.apple.com/'>Developer</a>
            <div id='ssi_SearchButton' role="button" title="Search">Search</div>
        </div>
        <form id='ssi_SearchMenu' method='get' action='../../../../../search/' accept-charset='utf-8'>
            <label for='adcsearch'>Search Documentation Archive</label>
            
            
    
            <input type='search' id='ssi_SearchField' name='q' accesskey='s' results='5' />
        </form>
    </div>

    <header id="header">
        <div id="title" role="banner">
            <h1>AppleScript Language Guide</h1>
            <span id="file_links">
                <a id="PDF_link" role="button" tabindex='4' rel="alternate" title="Download PDF"><span id="pdf_icon"></span>PDF</a>
                <a id="Companion_link" role="button" tabindex='3' title="Download Companion File"><span id="companion_icon"></span>Companion File</a>
            </span>
        </div>
        <ul id="headerButtons" class="hideOnPrint" role="toolbar">
            <li id="toc_button" style="display:none">
                <button tabindex="5" id="table_of_contents" class="open" role="checkbox" aria-label="Show Table of Contents"><span class="disclosure"></span>Table of Contents</button>
            </li>
            <li id="jumpto_button" style="display:none" role="navigation"><select tabindex="6" id="jumpTo"><option value="top">Jump To&#133;</option></select></li>
            <li id="downloadSample_button" style="display:none">
                <a id="Sample_link"><button id="Sample_button">Download Sample Code</button></a>
            </li>
        </ul>
    </header>
    <nav id="tocContainer" tabindex="7">
        <ul id="toc" role="tree"></ul>
    </nav>

    <article id="contents" tabindex="0" role="main">
        <div id="pageNavigationLinks_top" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../conceptual/ASLR_raw_data.html'>Next</a><a class='previousLink' rel='prev' href='ASLR_error_codes.html'>Previous</a>
        </div>
        <a id="top" name="top"></a>
        <a id="INDEX" href="../index.html" style="display:none;"></a>
        
        <a name="//apple_ref/doc/uid/TP40000983-CH221-SW1" title="Working with Errors"></a><h1 id="pageTitle">Working with Errors</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH221-DontLinkElementID_915"></a><a name="//apple_ref/doc/uid/TP40000983-CH221-DontLinkElementID_916"></a>This appendix provides a detailed example of handling errors with <span class="content_text"><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128973" data-renderer-version="1">try Statements</a></span> and <span class="content_text"><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129657" data-renderer-version="1">error Statements</a></span>. It shows how to use a <code>try</code> statement to check for bad data and other errors, and an <code>error</code> statement to pass on any error that can’t be handled. It also shows how to check for just a particular error number that you are interested in.</p><section><a name="//apple_ref/doc/uid/TP40000983-CH221-SW2" title="Catching Errors in a Handler"></a><h2 class="jump">Catching Errors in a Handler</h2><p>The <code>SumIntegerList</code> handler expects a list of integers. If any item in the passed list is not an integer, <code>SumIntegerList</code> signals <code>error number 750</code> and returns 0. The handler includes an error handler that displays a dialog if the error number is equal to 750; if the error number is not equal to 750, the handler resignals the error with an <code>error</code> statement so that other statements in the call chain can handle the unknown error. <a name="//apple_ref/doc/uid/TP40000983-CH221-DontLinkElementID_917"></a>If no statement handles the error, AppleScript displays an error dialog and execution stops.</p><div class="codesample clear"><table><tr><td scope="row"><pre>on SumIntegerList from itemList<span></span></pre></td></tr><tr><td scope="row"><pre>    try<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Initialize return value.<span></span></pre></td></tr><tr><td scope="row"><pre>        set integerSum to 0<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Before doing sum, check that all items in list are integers.<span></span></pre></td></tr><tr><td scope="row"><pre>        if ((count items in itemList) is not equal to ¬<span></span></pre></td></tr><tr><td scope="row"><pre>            (count integers in itemList)) then<span></span></pre></td></tr><tr><td scope="row"><pre>            -- If all items aren’t integers, signal an error.<span></span></pre></td></tr><tr><td scope="row"><pre>            error number 750<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Use a repeat statement to sum the integers in the list.<span></span></pre></td></tr><tr><td scope="row"><pre>        repeat with currentItem in itemList<span></span></pre></td></tr><tr><td scope="row"><pre>            set integerSum to integerSum + currentItem<span></span></pre></td></tr><tr><td scope="row"><pre>        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>        return integerSum -- Successful completion of handler.<span></span></pre></td></tr><tr><td scope="row"><pre>    on error errStr number errorNumber<span></span></pre></td></tr><tr><td scope="row"><pre>        -- If our own error number, warn about bad data.<span></span></pre></td></tr><tr><td scope="row"><pre>        if the errorNumber is equal to 750 then<span></span></pre></td></tr><tr><td scope="row"><pre>            display dialog "All items in the list must be integers."<span></span></pre></td></tr><tr><td scope="row"><pre>            return integerSum -- Return the default value (0).<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            -- An unknown error occurred. Resignal, so the caller<span></span></pre></td></tr><tr><td scope="row"><pre>            -- can handle it, or AppleScript can display the number.<span></span></pre></td></tr><tr><td scope="row"><pre>            error errStr number errorNumber<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end try<span></span></pre></td></tr><tr><td scope="row"><pre>end SumIntegerList<span></span></pre></td></tr></table></div><p>The <code>SumIntegerList</code> handler handles various error conditions. For example, the following call completes without error:</p><div class="codesample clear"><table><tr><td scope="row"><pre>set sumList to {1, 3, 5}<span></span></pre></td></tr><tr><td scope="row"><pre>set listTotal to SumIntegerList from sumList --result: 9<span></span></pre></td></tr></table></div><p>The following call passes bad data—the list contains an item that isn’t an integer:</p><div class="codesample clear"><table><tr><td scope="row"><pre>set sumList to {1, 3, 5, "A"}<span></span></pre></td></tr><tr><td scope="row"><pre>set listTotal to SumIntegerList from sumList<span></span></pre></td></tr><tr><td scope="row"><pre>if listTotal is equal to 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>    -- the handler didn’t total the list;<span></span></pre></td></tr><tr><td scope="row"><pre>    -- do something to handle the error (not shown)<span></span></pre></td></tr><tr><td scope="row"><pre>end if<span></span></pre></td></tr></table></div><p>The <code>SumIntegerList</code> routine checks the list and signals an error 750 because the list contains at least one non-integer item. The routine’s error handler recognizes error number 750 and puts up a dialog to describe the problem. The <code>SumIntegerList</code> routine returns 0. The script checks the return value and, if it is equal to 0, does something to handle the error (not shown).</p><p>Suppose some unknown error occurs while <code>SumIntegerList</code> is processing the integer list in the previous call. When the unknown error occurs, the <code>SumIntegerList</code> error handler calls the <code>error</code> command to resignal the error. Since the caller doesn’t handle it, AppleScript displays an error dialog and execution halts. The <code>SumIntegerList</code> routine does not return a value.</p><p>Finally, suppose the caller has its own error handler, so that if the handler passes on an error, the caller can handle it. Assume again that an unknown error occurs while <code>SumIntegerList</code> is processing the integer list.</p><div class="codesample clear"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    set sumList to {1, 3, 5}<span></span></pre></td></tr><tr><td scope="row"><pre>    set listTotal to SumIntegerList from sumList<span></span></pre></td></tr><tr><td scope="row"><pre>on error errMsg number errorNumber<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "An unknown error occurred:  " &amp; errorNumber as text<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><p>In this case, when the unknown error occurs, the <code>SumIntegerList</code> error handler calls the <code>error</code> command to resignal the error. Because the caller has an error handler, it is able to handle the error by displaying a dialog that includes the error number. Execution can continue if it is meaningful to do so.</p></section><section><a name="//apple_ref/doc/uid/TP40000983-CH221-SW3" title="Simplified Error Checking"></a><h2 class="jump">Simplified Error Checking</h2><p>AppleScript provides a mechanism to streamline the way you can catch and handle individual errors. It is often necessary for a script to handle a particular error, but not others. It is possible to catch an error, check for the error number you are interested in, and use an error statement to resignal for other errors. For example:</p><div class="codesample clear"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    open for access file "MyFolder:AddressData" with write permission<span></span></pre></td></tr><tr><td scope="row"><pre>on error msg number n from f to t partial result p<span></span></pre></td></tr><tr><td scope="row"><pre>    if n = -49 then -- File already open error<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "I'm sorry but the file is already open."<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        error msg number n from f to t partial result p<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><p>This script tries to open a file with write permission, but if the file is already opened, it just displays a dialog. However, you can instead implement this more concisely as:</p><div class="codesample clear"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    open for access file "MyFolder:AddressData" with write permission<span></span></pre></td></tr><tr><td scope="row"><pre>on error number -49<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "I'm sorry but the file is already open."<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><p>In this version, there is no need to list the <code>message</code>, <code>from</code>, <code>to</code>, or <code>partial result</code> parameters, in order to pass them along. If the error is not -49 (file &lt;name&gt; is already open), this error handler will not catch the error, and AppleScript will pass the error to the next handler in an outer scope.</p><p>One drawback to this approach is that you must use a literal constant for the error number in the <code>on error</code> parameter list. You can't use global variable or property names because the number must be known when the script is compiled.<a name="//apple_ref/doc/uid/TP40000983-CH221-DontLinkElementID_918"></a></p></section>
        <div id="pageNavigationLinks_bottom" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../conceptual/ASLR_raw_data.html'>Next</a><a class='previousLink' rel='prev' href='ASLR_error_codes.html'>Previous</a>
        </div><br/>
        <div class="copyright"><br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> Copyright &#x00a9; 2016 Apple Inc. All Rights Reserved.  <a href="http://www.apple.com/legal/internet-services/terms/site.html" target="_blank">Terms of Use</a>   |  <a href="http://www.apple.com/privacy/" target="_blank">Privacy Policy</a>  |  Updated: 2016-01-25</p></div></div>

        <div id="pediaWindow">
            <div id="pediaHeader"></div>
            <div id="pediaBody"></div>
        </div>
    </article>

    <div id="blackout">
    <div id="preload"></div>
</div>
<div id="modal" aria-hidden="true">
    <div id="closebox" tabindex="0" aria-label="Close feedback form" role="button"></div>
    <div id="sending" class="hidden">
        <h2 tabindex="0">Sending feedback&hellip;</h2>
        <div id="sending_img"></div>
    </div>
    <div id="error" class="hidden">
        <h2 tabindex="0">We&rsquo;re sorry, an error has occurred.</h2>
        <p>Please try submitting your feedback later.</p>
        <div id="error_icon"></div>
    </div>
    <div id="success" class="hidden">
        <h2 tabindex="0">Thank you for providing feedback!</h2>
        <p>Your input helps improve our developer documentation.</p>
        <div id="thank_you_icon"></div>
    </div>
    
    <form id="feedback" action="#" method="post">
        <div class="left-leaf">
            <h2 id="helpful_title" data-asterisk="a1" tabindex="0">How helpful is this document?</h2>     
            <sup id="a1" class="asterisk" aria-hidden="true">*</sup>

            <div id="star_group" role="radiogroup" aria-required="true">
                <label> 
                    <input class="radio" type="radio" name="helped" value="1" /> 
                    Very helpful
                </label>
                <label> 
                    <input class="radio" type="radio" name="helped" value="2" /> 
                    Somewhat helpful
                </label>
                <label>
                    <input class="radio" type="radio" name="helped" value="3" /> 
                    Not helpful
                </label>
            </div>
        </div>
        <div class="right-leaf">
            <h2>How can we improve this document?</h2>
            <div id="improve" class="checkboxes">
                <label>
                    <input type="checkbox" name="typo" /> 
                    Fix typos or links
                </label>
                <label>
                    <input type="checkbox" name="infoIncorrect" /> 
                    Fix incorrect information
                </label>
                <label>
                    <input type="checkbox" name="needs_examples" /> 
                    Add or update code samples
                </label>
                <label>
                    <input type="checkbox" name="needs_art" /> 
                    Add or update illustrations
                </label>
                <label>
                    <input type="checkbox" name="missingInfo" /> 
                    Add information about...
                </label>
            </div>
        </div>

        <textarea id="comment" name="problem" cols="70" rows="8" placeholder="Please tell us more about your experience with this document" data-asterisk="a2" required></textarea>
        <sup id="a2" class="asterisk" aria-hidden="true">*</sup>

        <p class="fineprint">
            <em aria-hidden="true"><span>*</span> Required information</em>
        </p> 

        <input id="submit" type="button" value="Send" />

        <section id="legal">
            <p>
                To submit a product bug or enhancement request, please visit the 
                <a href="https://developer.apple.com/bugreporter/" target="_blank">Bug Reporter</a> 
                page.
            </p>
            <p>
                Please read <a href="http://www.apple.com/legal/policies/ideas.html" target="_blank">Apple's Unsolicited Idea Submission Policy</a> 
                before you send us your feedback.
            </p> 
        </section>
    </form>
</div>

    
    <script charset="utf-8" src="../../../../../Resources/1282/JavaScript/lib/prototype.js"></script>
    <script src="../../../../../Resources/1282/JavaScript/library.js"></script>
</body>
</html>
