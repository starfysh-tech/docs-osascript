<!DOCTYPE html>
<html lang="en">
  <head>
  
  <title>Mac Automation Scripting Guide: Reading and Writing Files</title>
  <link rel="stylesheet" type="text/css" href="../../../../Resources/1282/CSS/style-1.6.3.css" />
  <link rel="stylesheet" type="text/css" href="../../../../Resources/1282/CSS/feedback-1.6.3.css" />
  <meta charset='utf-8'> 
<meta id="j-version" name="j-version" content="" />
<meta id="build" name="build" content="c1e4c7a89af8f899a21cfa81fc33ba42" />
<meta id="document-version" name="document-version" content="1.1.0" />
<meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Topic/Languages &amp; Utilities}" />
<meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/TP40016239" />
<meta id="chapterId" name="chapterId" content="TP40016239-CH58">
<meta id="book-title" name="book-title" content="Mac Automation Scripting Guide" />
<meta id="book-resource-type" name="book-resource-type" content="Guide" />
<meta id="book-root" name="book-root" content="./" />
<meta id="book-json" name="book-json" content="book.json">
<meta id="date" name="date" content="2016-06-13" />
<meta id="description" name="description" content="New document." />
<meta id="IndexTitle" name="IndexTitle" content="" />
<meta id="resources-uri" name="resources-uri" content="../../../../Resources/1282">
<link id="book-index-page" rel="Start" title="" type="text/html" href="./index.html">
<!-- , next_chapter: next_chapter, previous_chapter: previous_chapter -->
<link id="next-page" rel="Next" type="text/html" href="">
<link id="previous-page" rel="Prev" type="text/html" href="">
<meta id="devcenter" name="devcenter" content="<!-- DEVCENTER_NAME -->" />
<meta id="devcenter-url" name="devcenter-url" content="<!-- DEVCENTER_URL -->" />
<meta id="reflib" name="reflib" content="<!-- REFLIB_NAME -->" />

<meta id="xcode-display" name="xcode-display" content="render" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta id="platforms" name="platforms" content="OS X">
</head>

  <body id="conceptual_flow_with_tasks" class="jazz">
    
    <header id="ios_header" class="hideOnPrint hideInXcode">
  <div class="content-wrapper">
    <p class="header-text">
    	<a href="../../../../navigation/">Documentation Archive
 		</a>
 </p>
    <p id="wwdr"><img id="apple_logo" src="../../../../Resources/1282/Images/apple2.png" height="14px" width="12px" aria-hidden="true" /><a href="https://developer.apple.com">Developer</a></p>
  </div>
</header>

    <section id="valence">
  <div class="content-wrapper">
    <p id="hierarchial_navigation">
      <span id="book_title">Mac Automation Scripting Guide</span>
    </p>
    <form id="search" class="hideInXcode" method="get" action="/search/index.php" accept-charset="utf-8" autocomplete="off">
  <input type="search" id="ssi_SearchField" placeholder="Search Documentation Archive" name="q" autocomplete="off" tabindex="2" />
</form>

      
   
   



    <img id="shortstack" src="../../../../Resources/1282/Images/shortstack_2x.png"/>
  </div>
</section>
    <div class="content-wrapper">
      <nav id="navigator" class="book-parts hideInXcode" role="navigation">
    <ul class="nav-parts">
        <li data-id="//apple_ref/doc/uid/TP40016239-CH2-SW1"
            class="part-name">
            <a href="index.html#//apple_ref/doc/uid/TP40016239-CH56-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH56-SW1">Mac Scripting Essentials</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="index.html#//apple_ref/doc/uid/TP40016239-CH56-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH56-SW1">About Mac Scripting</a>
              </li>
              <li class="nav-chapter">
              	<a href="HowMacScriptingWorks.html#//apple_ref/doc/uid/TP40016239-CH73-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH73-SW1">How Mac Scripting Works</a>
              </li>
              <li class="nav-chapter">
              	<a href="TypesofScripts.html#//apple_ref/doc/uid/TP40016239-CH72-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH72-SW1">Types of Scripts</a>
              </li>
              <li class="nav-chapter">
              	<a href="AboutthisGuide.html#//apple_ref/doc/uid/TP40016239-CH71-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH71-SW1">About this Guide</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH10-SW1"
            class="part-name">
            <a href="GettoKnowScriptEditor.html#//apple_ref/doc/uid/TP40016239-CH5-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH5-SW1">Starting Scripting</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="GettoKnowScriptEditor.html#//apple_ref/doc/uid/TP40016239-CH5-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH5-SW1">Getting to Know Script Editor</a>
              </li>
              <li class="nav-chapter">
              	<a href="CreateaScript.html#//apple_ref/doc/uid/TP40016239-CH12-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH12-SW1">Creating a Script</a>
              </li>
              <li class="nav-chapter">
              	<a href="SaveaScript.html#//apple_ref/doc/uid/TP40016239-CH13-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH13-SW1">Saving a Script</a>
              </li>
              <li class="nav-chapter">
              	<a href="RunaScript.html#//apple_ref/doc/uid/TP40016239-CH14-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH14-SW1">Running a Script</a>
              </li>
              <li class="nav-chapter">
              	<a href="ConfigureScriptingPreferences.html#//apple_ref/doc/uid/TP40016239-CH70-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH70-SW1">Configuring Scripting Preferences</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH9-SW1"
            class="part-name">
            <a href="AboutScriptingTerminology.html#//apple_ref/doc/uid/TP40016239-CH75-SW2" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH75-SW2">Accessing Scripting Terminology</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="AboutScriptingTerminology.html#//apple_ref/doc/uid/TP40016239-CH75-SW2" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH75-SW2">About Scripting Terminology</a>
              </li>
              <li class="nav-chapter">
              	<a href="OpenaScriptingDictionary.html#//apple_ref/doc/uid/TP40016239-CH76-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH76-SW1">Opening a Scripting Dictionary</a>
              </li>
              <li class="nav-chapter">
              	<a href="NavigateaScriptingDictionary.html#//apple_ref/doc/uid/TP40016239-CH77-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH77-SW1">Navigating a Scripting Dictionary</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH74-SW1"
            class="part-name">
            <a href="UseHandlersFunctions.html#//apple_ref/doc/uid/TP40016239-CH52-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH52-SW1">Modularizing Code</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="UseHandlersFunctions.html#//apple_ref/doc/uid/TP40016239-CH52-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH52-SW1">Using Handlers/Functions</a>
              </li>
              <li class="nav-chapter">
              	<a href="UseScriptLibraries.html#//apple_ref/doc/uid/TP40016239-CH36-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH36-SW1">Using Script Libraries</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH57-SW1"
            class="part-name nav-part-active open-part">
            <a href="ReferenceFilesandFolders.html#//apple_ref/doc/uid/TP40016239-CH34-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH34-SW1">Working with Files and Folders</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="ReferenceFilesandFolders.html#//apple_ref/doc/uid/TP40016239-CH34-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH34-SW1">Referencing Files and Folders</a>
              </li>
              <li class="nav-chapter nav-current-chapter">
              	<a href="#//apple_ref/doc/uid/TP40016239-CH58-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH58-SW1">Reading and Writing Files</a>
              </li>
              <li class="nav-chapter">
              	<a href="ProcessDroppedFilesandFolders.html#//apple_ref/doc/uid/TP40016239-CH53-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH53-SW1">Processing Dropped Files and Folders</a>
              </li>
              <li class="nav-chapter">
              	<a href="WatchFolders.html#//apple_ref/doc/uid/TP40016239-CH39-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH39-SW1">Watching Folders</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH59-SW1"
            class="part-name">
            <a href="ManipulateText.html#//apple_ref/doc/uid/TP40016239-CH33-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH33-SW1">Working with Text, Numbers, and Lists</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="ManipulateText.html#//apple_ref/doc/uid/TP40016239-CH33-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH33-SW1">Manipulating Text</a>
              </li>
              <li class="nav-chapter">
              	<a href="ManipulateNumbers.html#//apple_ref/doc/uid/TP40016239-CH47-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH47-SW1">Manipulating Numbers</a>
              </li>
              <li class="nav-chapter">
              	<a href="ManipulateListsofItems.html#//apple_ref/doc/uid/TP40016239-CH48-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH48-SW1">Manipulating Lists of Items</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH60-SW1"
            class="part-name">
            <a href="DisplayDialogsandAlerts.html#//apple_ref/doc/uid/TP40016239-CH15-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH15-SW1">Interacting with Users</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="DisplayDialogsandAlerts.html#//apple_ref/doc/uid/TP40016239-CH15-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH15-SW1">Displaying Dialogs and Alerts</a>
              </li>
              <li class="nav-chapter">
              	<a href="PromptforText.html#//apple_ref/doc/uid/TP40016239-CH80-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH80-SW1">Prompting for Text</a>
              </li>
              <li class="nav-chapter">
              	<a href="DisplayNotifications.html#//apple_ref/doc/uid/TP40016239-CH61-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH61-SW1">Displaying Notifications</a>
              </li>
              <li class="nav-chapter">
              	<a href="SpeakText.html#//apple_ref/doc/uid/TP40016239-CH62-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH62-SW1">Speaking Text</a>
              </li>
              <li class="nav-chapter">
              	<a href="PromptforaFileorFolder.html#//apple_ref/doc/uid/TP40016239-CH81-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH81-SW1">Prompting for Files or Folders</a>
              </li>
              <li class="nav-chapter">
              	<a href="PromptforaFileName.html#//apple_ref/doc/uid/TP40016239-CH82-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH82-SW1">Prompting for a File Name</a>
              </li>
              <li class="nav-chapter">
              	<a href="PromptforaChoicefromaList.html#//apple_ref/doc/uid/TP40016239-CH83-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH83-SW1">Prompting for a Choice from a List</a>
              </li>
              <li class="nav-chapter">
              	<a href="PromptforaColor.html#//apple_ref/doc/uid/TP40016239-CH86-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH86-SW1">Prompting for a Color</a>
              </li>
              <li class="nav-chapter">
              	<a href="DisplayProgress.html#//apple_ref/doc/uid/TP40016239-CH37-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH37-SW1">Displaying Progress</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH63-SW1"
            class="part-name">
            <a href="ConvertRGBtoHTMLColor.html#//apple_ref/doc/uid/TP40016239-CH49-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH49-SW1">Working with HTML and URLs</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="ConvertRGBtoHTMLColor.html#//apple_ref/doc/uid/TP40016239-CH49-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH49-SW1">Converting RGB to HTML Color</a>
              </li>
              <li class="nav-chapter">
              	<a href="EncodeandDecodeText.html#//apple_ref/doc/uid/TP40016239-CH51-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH51-SW1">Encoding and Decoding Text</a>
              </li>
              <li class="nav-chapter">
              	<a href="ParseHTML.html#//apple_ref/doc/uid/TP40016239-CH50-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH50-SW1">Parsing HTML</a>
              </li>
              <li class="nav-chapter">
              	<a href="RemoveMarkupfromHTML.html#//apple_ref/doc/uid/TP40016239-CH64-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH64-SW1">Removing HTML Markup from Text</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH65-SW1"
            class="part-name">
            <a href="WorkwithPropertyListFiles.html#//apple_ref/doc/uid/TP40016239-CH66-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH66-SW1">Working with Data</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="WorkwithPropertyListFiles.html#//apple_ref/doc/uid/TP40016239-CH66-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH66-SW1">Working with Property List Files</a>
              </li>
              <li class="nav-chapter">
              	<a href="WorkwithXML.html#//apple_ref/doc/uid/TP40016239-CH67-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH67-SW1">Working with XML</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH35-SW1"
            class="part-name">
            <a href="AutomatetheUserInterface.html#//apple_ref/doc/uid/TP40016239-CH69-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH69-SW1">Performing Common Scripting Tasks</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="AutomatetheUserInterface.html#//apple_ref/doc/uid/TP40016239-CH69-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH69-SW1">Automating the User Interface</a>
              </li>
              <li class="nav-chapter">
              	<a href="ManipulateImages.html#//apple_ref/doc/uid/TP40016239-CH20-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH20-SW1">Manipulating Images</a>
              </li>
              <li class="nav-chapter">
              	<a href="CallCommandLineUtilities.html#//apple_ref/doc/uid/TP40016239-CH43-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH43-SW1">Calling Command-Line Tools</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH68-SW1"
            class="part-name">
            <a href="MakeaSystem-WideService.html#//apple_ref/doc/uid/TP40016239-CH46-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH46-SW1">Extending Apps and Processes</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="MakeaSystem-WideService.html#//apple_ref/doc/uid/TP40016239-CH46-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH46-SW1">Making a Systemwide Service</a>
              </li>
              <li class="nav-chapter">
              	<a href="UsetheSystem-WideScriptMenu.html#//apple_ref/doc/uid/TP40016239-CH7-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH7-SW1">Using the Systemwide Script Menu</a>
              </li>
              <li class="nav-chapter">
              	<a href="UseDictationtoRunScripts.html#//apple_ref/doc/uid/TP40016239-CH87-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH87-SW1">Using Dictation to Run Scripts</a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40016239-CH78-SW1"
            class="part-name">
            <a href="AppendixA-AppleScriptObjCQuickTranslationGuide.html#//apple_ref/doc/uid/TP40016239-CH79-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH79-SW1">Appendixes</a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="AppendixA-AppleScriptObjCQuickTranslationGuide.html#//apple_ref/doc/uid/TP40016239-CH79-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH79-SW1">Objective-C to AppleScript Quick Translation Guide</a>
              </li>
          </ul>
        </li>
        <li data-id="revision-history"
            class="part-name">
          <a href="RevisionHistory.html#//apple_ref/doc/uid/TP40016239-CH99-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH99-SW1">Revision History</a>
          <ul class="nav-chapters">
            <li class="nav-chapter">
              <a href="RevisionHistory.html#//apple_ref/doc/uid/TP40016239-CH99-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH99-SW1">Document Revision History</a>
            </li>
          </ul>
        </li>
    </ul>
</nav>

      <menu id="bashful" type="toolbar">
  <div class="shield"></div>
  <menuitem id="jump_to" class="menu-bar-item closed">
  <span>On This Page</span>
  <div class="chevron">
    <div class="chevy chevron-left"></div>
    <div class="chevy chevron-right"></div>
  </div>
  <menu type="list" class="details">
      <ul class="list-bullet">
          <li class="item">
            <a href="#//apple_ref/doc/uid/TP40016239-CH58-SW3">Writing to a File</a>
          </li>
          <li class="item">
            <a href="#//apple_ref/doc/uid/TP40016239-CH58-SW2">Reading a File</a>
          </li>
      </ul>
  </menu>
</menuitem>

</menu>
<div class="pixel-line"></div>
<div class="rubber-band-gap"></div>
<article class="chapter">
  <a name="//apple_ref/doc/uid/TP40016239-CH58"></a><a name="//apple_ref/doc/uid/TP40016239-CH58-SW1"></a>

  <h2 class='chapter-name'>Reading and Writing Files</h2>


  
  	<section class="section">
  		<p class="para">
  Scripts are often designed to write data to files such as logs or backups. The Standard Additions scripting addition contains a number of commands that make it possible to read and write files.
</p>

		</section> 


  <section class="section">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW3"></a>
  <h3 class="section-name" tabindex="0">Writing to a File</h3>
  <p class="para">
  The handlers in <span class="x-name-no-link">Listing 16-1</span> and <span class="x-name-no-link">Listing 16-2</span> safely write data to disk, creating a new file if the targeted file doesn’t already exist. Provide the text to write, a target file path, and indicate whether to overwrite existing content. If you choose not to overwrite existing content, then the text provided is appended to any existing content.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=on%20writeTextToFile%28theText%2C%20theFile%2C%20overwriteExistingContent%29%0A%20%20%20%20try%0A%0A%20%20%20%20%20%20%20%20--%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20%20%20%20%20set%20theFile%20to%20theFile%20as%20string%0A%0A%20%20%20%20%20%20%20%20--%20Open%20the%20file%20for%20writing%0A%20%20%20%20%20%20%20%20set%20theOpenedFile%20to%20open%20for%20access%20file%20theFile%20with%20write%20permission%0A%0A%20%20%20%20%20%20%20%20--%20Clear%20the%20file%20if%20content%20should%20be%20overwritten%0A%20%20%20%20%20%20%20%20if%20overwriteExistingContent%20is%20true%20then%20set%20eof%20of%20theOpenedFile%20to%200%0A%0A%20%20%20%20%20%20%20%20--%20Write%20the%20new%20content%20to%20the%20file%0A%20%20%20%20%20%20%20%20write%20theText%20to%20theOpenedFile%20starting%20at%20eof%0A%0A%20%20%20%20%20%20%20%20--%20Close%20the%20file%0A%20%20%20%20%20%20%20%20close%20access%20theOpenedFile%0A%0A%20%20%20%20%20%20%20%20--%20Return%20a%20boolean%20indicating%20that%20writing%20was%20successful%0A%20%20%20%20%20%20%20%20return%20true%0A%0A%20%20%20%20%20%20%20%20--%20Handle%20a%20write%20error%0A%20%20%20%20on%20error%0A%0A%20%20%20%20%20%20%20%20--%20Close%20the%20file%0A%20%20%20%20%20%20%20%20try%0A%20%20%20%20%20%20%20%20%20%20%20%20close%20access%20file%20theFile%0A%20%20%20%20%20%20%20%20end%20try%0A%0A%20%20%20%20%20%20%20%20--%20Return%20a%20boolean%20indicating%20that%20writing%20failed%0A%20%20%20%20%20%20%20%20return%20false%0A%20%20%20%20end%20try%0Aend%20writeTextToFile">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW4"></a>
    <span class="caption"><strong class="caption-number">Listing 16-1</strong>AppleScript: Handler that writes text to a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">on writeTextToFile(theText, theFile, overwriteExistingContent)</code></li>
            <li><code class="code-voice">    try</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Convert the file to a string</code></li>
            <li><code class="code-voice">        set theFile to theFile as string</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Open the file for writing</code></li>
            <li><code class="code-voice">        set theOpenedFile to open for access file theFile with write permission</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Clear the file if content should be overwritten</code></li>
            <li><code class="code-voice">        if overwriteExistingContent is true then set eof of theOpenedFile to 0</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Write the new content to the file</code></li>
            <li><code class="code-voice">        write theText to theOpenedFile starting at eof</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Close the file</code></li>
            <li><code class="code-voice">        close access theOpenedFile</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Return a boolean indicating that writing was successful</code></li>
            <li><code class="code-voice">        return true</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Handle a write error</code></li>
            <li><code class="code-voice">    on error</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Close the file</code></li>
            <li><code class="code-voice">        try</code></li>
            <li><code class="code-voice">            close access file theFile</code></li>
            <li><code class="code-voice">        end try</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        -- Return a boolean indicating that writing failed</code></li>
            <li><code class="code-voice">        return false</code></li>
            <li><code class="code-voice">    end try</code></li>
            <li><code class="code-voice">end writeTextToFile</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Afunction%20writeTextToFile%28text%2C%20file%2C%20overwriteExistingContent%29%20%7B%0A%20%20%20%20try%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20%20%20%20%20var%20fileString%20%3D%20file.toString%28%29%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Open%20the%20file%20for%20writing%0A%20%20%20%20%20%20%20%20var%20openedFile%20%3D%20app.openForAccess%28Path%28fileString%29%2C%20%7B%20writePermission%3A%20true%20%7D%29%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Clear%20the%20file%20if%20content%20should%20be%20overwritten%0A%20%20%20%20%20%20%20%20if%20%28overwriteExistingContent%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20app.setEof%28openedFile%2C%20%7B%20to%3A%200%20%7D%29%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Write%20the%20new%20content%20to%20the%20file%0A%20%20%20%20%20%20%20%20app.write%28text%2C%20%7B%20to%3A%20openedFile%2C%20startingAt%3A%20app.getEof%28openedFile%29%20%7D%29%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Close%20the%20file%0A%20%20%20%20%20%20%20%20app.closeAccess%28openedFile%29%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Return%20a%20boolean%20indicating%20that%20writing%20was%20successful%0A%20%20%20%20%20%20%20%20return%20true%0A%20%20%20%20%7D%0A%20%20%20%20%C5%93%20%28error%29%20%7B%0A%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Close%20the%20file%0A%20%20%20%20%20%20%20%20%20%20%20%20app.closeAccess%28file%29%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20catch%28error%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Report%20the%20error%20is%20closing%20failed%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log%28%60Couldn%27t%20close%20file%3A%20%24%7Berror%7D%60%29%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Return%20a%20boolean%20indicating%20that%20writing%20was%20successful%0A%20%20%20%20%20%20%20%20return%20false%0A%20%20%20%20%7D%0A%7D">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW13"></a>
    <span class="caption"><strong class="caption-number">Listing 16-2</strong>JavaScript: Function that writes text to a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var app = Application.currentApplication()</code></li>
            <li><code class="code-voice">app.includeStandardAdditions = true</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">function writeTextToFile(text, file, overwriteExistingContent) {</code></li>
            <li><code class="code-voice">    try {</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Convert the file to a string</code></li>
            <li><code class="code-voice">        var fileString = file.toString()</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Open the file for writing</code></li>
            <li><code class="code-voice">        var openedFile = app.openForAccess(Path(fileString), { writePermission: true })</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Clear the file if content should be overwritten</code></li>
            <li><code class="code-voice">        if (overwriteExistingContent) {</code></li>
            <li><code class="code-voice">            app.setEof(openedFile, { to: 0 })</code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Write the new content to the file</code></li>
            <li><code class="code-voice">        app.write(text, { to: openedFile, startingAt: app.getEof(openedFile) })</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Close the file</code></li>
            <li><code class="code-voice">        app.closeAccess(openedFile)</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Return a boolean indicating that writing was successful</code></li>
            <li><code class="code-voice">        return true</code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">    catch(error) {</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        try {</code></li>
            <li><code class="code-voice">            // Close the file</code></li>
            <li><code class="code-voice">            app.closeAccess(file)</code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        catch(error) {</code></li>
            <li><code class="code-voice">            // Report the error is closing failed</code></li>
            <li><code class="code-voice">            console.log(`Couldn&#39;t close file: ${error}`)</code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">        // Return a boolean indicating that writing was successful</code></li>
            <li><code class="code-voice">        return false</code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <span class="x-name-no-link">Listing 16-3</span> and <span class="x-name-no-link">Listing 16-4</span> show how to call the handlers in <span class="x-name-no-link">Listing 16-1</span> and <span class="x-name-no-link">Listing 16-2</span> to write text content to a file on the Desktop, replacing any existing content in the file.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=set%20this_story%20to%20%22Once%20upon%20a%20time%20in%20Silicon%20Valley...%22%0Aset%20theFile%20to%20%28%28%28path%20to%20desktop%20folder%29%20as%20string%29%20%26%20%22MY%20STORY.txt%22%29%0AwriteTextToFile%28this_story%2C%20theFile%2C%20true%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW5"></a>
    <span class="caption"><strong class="caption-number">Listing 16-3</strong>AppleScript: Calling a handler to write text to a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">set this_story to &quot;Once upon a time in Silicon Valley...&quot;</code></li>
            <li><code class="code-voice">set theFile to (((path to desktop folder) as string) &amp; &quot;MY STORY.txt&quot;)</code></li>
            <li><code class="code-voice">writeTextToFile(this_story, theFile, true)</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20story%20%3D%20%22Once%20upon%20a%20time%20in%20Silicon%20Valley...%22%0Avar%20desktopString%20%3D%20app.pathTo%28%22desktop%22%29.toString%28%29%0Avar%20file%20%3D%20%60%24%7BdesktopString%7D%2FMY%20STORY.txt%60%0AwriteTextToFile%28story%2C%20file%2C%20true%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW14"></a>
    <span class="caption"><strong class="caption-number">Listing 16-4</strong>JavaScript: Calling a function to write text to a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var story = &quot;Once upon a time in Silicon Valley...&quot;</code></li>
            <li><code class="code-voice">var desktopString = app.pathTo(&quot;desktop&quot;).toString()</code></li>
            <li><code class="code-voice">var file = `${desktopString}/MY STORY.txt`</code></li>
            <li><code class="code-voice">writeTextToFile(story, file, true)</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <span class="x-name-no-link">Listing 16-5</span> and <span class="x-name-no-link">Listing 16-6</span> show how <span class="x-name-no-link">Listing 16-1</span> and <span class="x-name-no-link">Listing 16-2</span> could be called to insert dated log entries into a log file.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=set%20theText%20to%20%28%28current%20date%29%20as%20string%29%20%26%20space%20%26%20%22STATUS%20OK%22%20%26%20return%0Aset%20theFile%20to%20%28%28%28path%20to%20desktop%20folder%29%20as%20string%29%20%26%20%22MY%20LOG%20FILE.log%22%29%0AwriteTextToFile%28theText%2C%20theFile%2C%20false%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW6"></a>
    <span class="caption"><strong class="caption-number">Listing 16-5</strong>AppleScript: Calling a handler to write an entry to a log file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">set theText to ((current date) as string) &amp; space &amp; &quot;STATUS OK&quot; &amp; return</code></li>
            <li><code class="code-voice">set theFile to (((path to desktop folder) as string) &amp; &quot;MY LOG FILE.log&quot;)</code></li>
            <li><code class="code-voice">writeTextToFile(theText, theFile, false)</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20dateString%20%3D%20Date%28%29.toString%28%29%0Avar%20desktopString%20%3D%20app.pathTo%28%22desktop%22%29.toString%28%29%0Avar%20text%20%3D%20%60%24%7BdateString%7D%20STATUS%20OK%5Cn%5Cn%60%0Avar%20file%20%3D%20%60%24%7BdesktopString%7D%2FMY%20LOG%20FILE.log%60%0AwriteTextToFile%28text%2C%20file%2C%20false%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW15"></a>
    <span class="caption"><strong class="caption-number">Listing 16-6</strong>JavaScript: Calling a function to write an entry to a log file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var dateString = Date().toString()</code></li>
            <li><code class="code-voice">var desktopString = app.pathTo(&quot;desktop&quot;).toString()</code></li>
            <li><code class="code-voice">var text = `${dateString} STATUS OK\n\n`</code></li>
            <li><code class="code-voice">var file = `${desktopString}/MY LOG FILE.log`</code></li>
            <li><code class="code-voice">writeTextToFile(text, file, false)</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  In practice, this technique could be used to maintain a log when script errors occur. <span class="x-name-no-link">Listing 16-7</span> and <span class="x-name-no-link">Listing 16-8</span> are try statements, which can be wrapped around custom script code in order to log any script errors to a file in the <code class="code-voice">~/Library/Logs/</code> folder of the current user’s home directory.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=try%0A%20%20%20%20--%20Your%20custom%20script%20code%20goes%20here%0Aon%20error%20theErrorMessage%20number%20theErrorNumber%0A%20%20%20%20set%20theError%20to%20%22Error%3A%20%22%20%26%20theErrorNumber%20%26%20%22.%20%22%20%26%20theErrorMessage%20%26%20return%0A%20%20%20%20set%20theLogFile%20to%20%28%28path%20to%20library%20folder%20from%20user%20domain%29%20as%20string%29%20%26%20%22Logs%3AScript%20Error%20Log.log%22%0A%20%20%20%20my%20writeTextToFile%28theError%2C%20theLogFile%2C%20false%29%0Aend%20try">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW7"></a>
    <span class="caption"><strong class="caption-number">Listing 16-7</strong>AppleScript: Example of a try statement that writes an entry to a log file when an error occurs</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">try</code></li>
            <li><code class="code-voice">    -- Your custom script code goes here</code></li>
            <li><code class="code-voice">on error theErrorMessage number theErrorNumber</code></li>
            <li><code class="code-voice">    set theError to &quot;Error: &quot; &amp; theErrorNumber &amp; &quot;. &quot; &amp; theErrorMessage &amp; return</code></li>
            <li><code class="code-voice">    set theLogFile to ((path to library folder from user domain) as string) &amp; &quot;Logs:Script Error Log.log&quot;</code></li>
            <li><code class="code-voice">    my writeTextToFile(theError, theLogFile, false)</code></li>
            <li><code class="code-voice">end try</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=try%20%7B%0A%20%20%20%20%2F%2F%20Your%20custom%20script%20code%20goes%20here%0A%7D%0Acatch%20%28error%29%20%7B%0A%20%20%20%20var%20errorString%20%3D%20%60Error%3A%20%24%7Berror.message%7D%5Cn%5Cn%60%0A%20%20%20%20var%20logFile%20%3D%20app.pathTo%28%22library%20folder%22%2C%20%7B%20from%3A%20%22user%20domain%22%20%7D%29.toString%28%29%20%2B%20%22%2FLogs%2FScript%20Error%20Log.log%22%0A%20%20%20%20writeTextToFile%28errorString%2C%20logFile%2C%20false%29%0A%7D">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW16"></a>
    <span class="caption"><strong class="caption-number">Listing 16-8</strong>JavaScript: Example of a try statement that writes an entry to a log file when an error occurs</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">try {</code></li>
            <li><code class="code-voice">    // Your custom script code goes here</code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice">catch (error) {</code></li>
            <li><code class="code-voice">    var errorString = `Error: ${error.message}\n\n`</code></li>
            <li><code class="code-voice">    var logFile = app.pathTo(&quot;library folder&quot;, { from: &quot;user domain&quot; }).toString() + &quot;/Logs/Script Error Log.log&quot;</code></li>
            <li><code class="code-voice">    writeTextToFile(errorString, logFile, false)</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW2"></a>
  <h3 class="section-name" tabindex="0">Reading a File</h3>
  <p class="para">
  The handlers in <span class="x-name-no-link">Listing 16-9</span> and <span class="x-name-no-link">Listing 16-10</span> read the contents of a specified file.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=on%20readFile%28theFile%29%0A%20%20%20%20--%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20set%20theFile%20to%20theFile%20as%20string%0A%0A%20%20%20%20--%20Read%20the%20file%20and%20return%20its%20contents%0A%20%20%20%20return%20read%20file%20theFile%0Aend%20readFile">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW8"></a>
    <span class="caption"><strong class="caption-number">Listing 16-9</strong>AppleScript: Handler that reads the contents of a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">on readFile(theFile)</code></li>
            <li><code class="code-voice">    -- Convert the file to a string</code></li>
            <li><code class="code-voice">    set theFile to theFile as string</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">    -- Read the file and return its contents</code></li>
            <li><code class="code-voice">    return read file theFile</code></li>
            <li><code class="code-voice">end readFile</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Afunction%20readFile%28file%29%20%7B%0A%20%20%20%20%2F%2F%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20var%20fileString%20%3D%20file.toString%28%29%0A%0A%20%20%20%20%2F%2F%20Read%20the%20file%20and%20return%20its%20contents%0A%20%20%20%20return%20app.read%28Path%28fileString%29%29%0A%7D">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW17"></a>
    <span class="caption"><strong class="caption-number">Listing 16-10</strong>JavaScript: Function that reads the contents of a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var app = Application.currentApplication()</code></li>
            <li><code class="code-voice">app.includeStandardAdditions = true</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">function readFile(file) {</code></li>
            <li><code class="code-voice">    // Convert the file to a string</code></li>
            <li><code class="code-voice">    var fileString = file.toString()</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">    // Read the file and return its contents</code></li>
            <li><code class="code-voice">    return app.read(Path(fileString))</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <span class="x-name-no-link">Listing 16-11</span> and <span class="x-name-no-link">Listing 16-12</span> show how to call the handlers in <span class="x-name-no-link">Listing 16-9</span> and <span class="x-name-no-link">Listing 16-10</span> to read a specified text file.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=set%20theFile%20to%20choose%20file%20of%20type%20%22txt%22%20with%20prompt%20%22Please%20select%20a%20text%20file%20to%20read%3A%22%0AreadFile%28theFile%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW9"></a>
    <span class="caption"><strong class="caption-number">Listing 16-11</strong>AppleScript: Calling a handler to read the contents of a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">set theFile to choose file of type &quot;txt&quot; with prompt &quot;Please select a text file to read:&quot;</code></li>
            <li><code class="code-voice">readFile(theFile)</code></li>
            <li><code class="code-voice">--&gt; Result: &quot;Contents of the chosen file.&quot;</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20file%20%3D%20app.chooseFile%28%7B%0A%20%20%20%20ofType%3A%20%22txt%22%2C%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20a%20text%20file%20to%20read%3A%22%0A%7D%29%0A%0AreadFile%28file%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW18"></a>
    <span class="caption"><strong class="caption-number">Listing 16-12</strong>JavaScript: Calling a function to read the contents of a file</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var file = app.chooseFile({</code></li>
            <li><code class="code-voice">    ofType: &quot;txt&quot;,</code></li>
            <li><code class="code-voice">    withPrompt: &quot;Please select a text file to read:&quot;</code></li>
            <li><code class="code-voice">})</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">readFile(file)</code></li>
            <li><code class="code-voice">// Result: &quot;Contents of the chosen file.&quot;</code></li>
        </ol>
      </div>
  </div>
</section>
  <section class="section">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW10"></a>
  <h3 class="section-name" tabindex="0">Reading and Splitting a File</h3>
  <p class="para">
  The handlers in <span class="x-name-no-link">Listing 16-13</span> and <span class="x-name-no-link">Listing 16-14</span> read the contents of a specified text file, using a delimiter to split it into a list.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=on%20readAndSplitFile%28theFile%2C%20theDelimiter%29%0A%20%20%20%20--%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20set%20theFile%20to%20theFile%20as%20string%0A%0A%20%20%20%20--%20Read%20the%20file%20using%20a%20specific%20delimiter%20and%20return%20the%20results%0A%20%20%20%20return%20read%20file%20theFile%20using%20delimiter%20%7BtheDelimiter%7D%0Aend%20readAndSplitFile">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW11"></a>
    <span class="caption"><strong class="caption-number">Listing 16-13</strong>AppleScript: Handler for reading and splitting the contents of a file based on a delimiter</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">on readAndSplitFile(theFile, theDelimiter)</code></li>
            <li><code class="code-voice">    -- Convert the file to a string</code></li>
            <li><code class="code-voice">    set theFile to theFile as string</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">    -- Read the file using a specific delimiter and return the results</code></li>
            <li><code class="code-voice">    return read file theFile using delimiter {theDelimiter}</code></li>
            <li><code class="code-voice">end readAndSplitFile</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Afunction%20readAndSplitFile%28file%2C%20delimiter%29%20%7B%0A%20%20%20%20%2F%2F%20Convert%20the%20file%20to%20a%20string%0A%20%20%20%20var%20fileString%20%3D%20file.toString%28%29%0A%0A%20%20%20%20%2F%2F%20Read%20the%20file%20using%20a%20specific%20delimiter%20and%20return%20the%20results%0A%20%20%20%20return%20app.read%28Path%28fileString%29%2C%20%7B%20usingDelimiter%3A%20delimiter%20%7D%29%0A%7D">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW19"></a>
    <span class="caption"><strong class="caption-number">Listing 16-14</strong>JavaScript: Function for reading and splitting the contents of a file based on a delimiter</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var app = Application.currentApplication()</code></li>
            <li><code class="code-voice">app.includeStandardAdditions = true</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">function readAndSplitFile(file, delimiter) {</code></li>
            <li><code class="code-voice">    // Convert the file to a string</code></li>
            <li><code class="code-voice">    var fileString = file.toString()</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice">    // Read the file using a specific delimiter and return the results</code></li>
            <li><code class="code-voice">    return app.read(Path(fileString), { usingDelimiter: delimiter })</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <span class="x-name-no-link">Listing 16-15</span> and <span class="x-name-no-link">Listing 16-16</span> shows how to call the handlers in <span class="x-name-no-link">Listing 16-13</span> and <span class="x-name-no-link">Listing 16-14</span> to read the paragraphs of a chosen log file.
</p><p class="para">
  <strong class="inline-head">APPLESCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=set%20theFile%20to%20choose%20file%20of%20type%20%22log%22%20with%20prompt%20%22Please%20select%20a%20log%20file%3A%22%0AreadAndSplitFile%28theFile%2C%20return%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW12"></a>
    <span class="caption"><strong class="caption-number">Listing 16-15</strong>AppleScript: Calling a handler to read and split the contents of a file based on a delimiter</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">set theFile to choose file of type &quot;log&quot; with prompt &quot;Please select a log file:&quot;</code></li>
            <li><code class="code-voice">readAndSplitFile(theFile, return)</code></li>
            <li><code class="code-voice">--&gt; Result: {&quot;Log entry 1&quot;, &quot;Log entry 2&quot;, ... }</code></li>
        </ol>
      </div>
  </div>
</section><p class="para">
  <strong class="inline-head">JAVASCRIPT</strong>
</p><p class="para">
  <a href="applescript://com.apple.scripteditor?action=new&amp;script=var%20file%20%3D%20app.chooseFile%28%7B%0A%20%20%20%20ofType%3A%20%22log%22%2C%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20a%20log%20file%3A%22%0A%7D%29%0AreadAndSplitFile%28file%2C%20%22%5Cn%22%29">Open in Script Editor</a>
</p><section class="code-listing">
  <a name="//apple_ref/doc/uid/TP40016239-CH58-SW20"></a>
    <span class="caption"><strong class="caption-number">Listing 16-16</strong>JavaScript: Calling a function to read and split the contents of a file based on a delimiter</span>
  <div class="code-sample">
      <div class="">
        <ol class="code-lines">
            <li><code class="code-voice">var file = app.chooseFile({</code></li>
            <li><code class="code-voice">    ofType: &quot;log&quot;,</code></li>
            <li><code class="code-voice">    withPrompt: &quot;Please select a log file:&quot;</code></li>
            <li><code class="code-voice">})</code></li>
            <li><code class="code-voice">readAndSplitFile(file, &quot;\n&quot;)</code></li>
            <li><code class="code-voice">// Result: [&quot;Log entry 1&quot;, &quot;Log entry 2&quot;, ...]</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>

</section>

  	
 	<section id="next_previous" class="">
    		<p class="previous-link"><a href="ReferenceFilesandFolders.html#//apple_ref/doc/uid/TP40016239-CH34-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH34-SW1">Referencing Files and Folders</a></p>
  			<p class="next-link"><a href="ProcessDroppedFilesandFolders.html#//apple_ref/doc/uid/TP40016239-CH53-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH53-SW1">Processing Dropped Files and Folders</a></p>

    <p class="copyright">Copyright &#x00a9; 2018 Apple Inc. All rights reserved. 
  <a class="link" href="http://www.apple.com/legal/terms/site.html" target="_blank" rel="external">Terms of Use</a> | 
  <a class="link" href="http://www.apple.com/privacy/" target="_blank" rel="external">Privacy Policy</a> | 
  <a href="RevisionHistory.html#//apple_ref/doc/uid/TP40016239-CH99-SW1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40016239-CH99-SW1">Updated: 2016-06-13</a>
</p>
  </section>
</article>

    </div>
    <div id='big_button'></div>
    <footer id="footer">
  <script src="../../../../Resources/1282/JavaScript/devpubs-1.6.3.js" type="text/javascript" charset="utf-8"></script>
  <div id="_omniture_top">
<!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
<script type="text/javascript">
/* RSID: */
var s_account="awdappledeveloper"
</script>

<script type="text/javascript" src="https://developer.apple.com/assets/metrics/scripts/analytics.js"></script>
<script type="text/javascript">
s.channel="www.documentationarchive.developer"

/************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
var s_code=s.t();if(s_code)document.write(s_code)</script>
<!-- End SiteCatalyst code version: H.8. -->
</div>

</footer>

    
  </body>
    <div id="blackout">
    <div id="preload"></div>
</div>
<div id="modal" aria-hidden="true">
    <div id="closebox" tabindex="0" aria-label="Close feedback form" role="button"></div>
    <div id="sending" class="hidden">
        <h2 tabindex="0">Sending feedback&hellip;</h2>
        <div id="sending_img"></div>
    </div>
    <div id="error" class="hidden">
        <h2 tabindex="0">We&rsquo;re sorry, an error has occurred.</h2>
        <p>Please try submitting your feedback later.</p>
        <div id="error_icon"></div>
    </div>
    <div id="success" class="hidden">
        <h2 tabindex="0">Thank you for providing feedback!</h2>
        <p>Your input helps improve our developer documentation.</p>
        <div id="thank_you_icon"></div>
    </div>
    
    <form id="feedback" action="#" method="post">
        <div class="left-leaf">
            <h2 id="helpful_title" data-asterisk="a1" tabindex="0">How helpful is this document?</h2>     
            <sup id="a1" class="asterisk" aria-hidden="true">*</sup>

            <div id="star_group" role="radiogroup" aria-required="true">
                <label> 
                    <input class="radio" type="radio" name="helped" value="1" /> 
                    Very helpful
                </label>
                <label> 
                    <input class="radio" type="radio" name="helped" value="2" /> 
                    Somewhat helpful
                </label>
                <label>
                    <input class="radio" type="radio" name="helped" value="3" /> 
                    Not helpful
                </label>
            </div>
        </div>
        <div class="right-leaf">
            <h2>How can we improve this document?</h2>
            <div id="improve" class="checkboxes">
                <label>
                    <input type="checkbox" name="typo" /> 
                    Fix typos or links
                </label>
                <label>
                    <input type="checkbox" name="infoIncorrect" /> 
                    Fix incorrect information
                </label>
                <label>
                    <input type="checkbox" name="needs_examples" /> 
                    Add or update code samples
                </label>
                <label>
                    <input type="checkbox" name="needs_art" /> 
                    Add or update illustrations
                </label>
                <label>
                    <input type="checkbox" name="missingInfo" /> 
                    Add information about...
                </label>
            </div>
        </div>

        <textarea id="comment" name="problem" cols="70" rows="8" placeholder="Please tell us more about your experience with this document" data-asterisk="a2" required></textarea>
        <sup id="a2" class="asterisk" aria-hidden="true">*</sup>

        <p class="fineprint">
            <em aria-hidden="true"><span>*</span> Required information</em>
        </p> 

        <input id="submit" type="button" value="Send" />

        <section id="legal">
            <p>
                To submit a product bug or enhancement request, please visit the 
                <a href="https://developer.apple.com/bugreporter/" target="_blank">Bug Reporter</a> 
                page.
            </p>
            <p>
                Please read <a href="http://www.apple.com/legal/policies/ideas.html" target="_blank">Apple's Unsolicited Idea Submission Policy</a> 
                before you send us your feedback.
            </p> 
        </section>
    </form>
</div>

</div>
</html>
