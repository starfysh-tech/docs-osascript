{
  "collection": "jxa-release-notes",
  "path": "Articles/OSX10-10.md",
  "title": "OS X 10.10 Release Notes",
  "body": "<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW1\"></a>\n\n# OS X 10.10 Release Notes\n\nThis article describes JavaScript for Automation, a new feature in OS X Yosemite.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW2\"></a>\n\n## Global Properties\n\nJavaScript for Automation is a host environment for JavaScript that adds the following global properties:\n\n* `Automation`\n* `Application`\n* `Library`\n* `Path`\n* `Progress`\n* `ObjectSpecifier`\n* `delay`\n* `console.log`\n* `ObjC`\n* `Ref`\n* `$`\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW3\"></a>\n\n### Open Scripting Architecture (OSA) Component\n\nThe JavaScript OSA component implements JavaScript for Automation. The component can be used from Script Editor, the system-wide Script menu, the Run JavaScript Automator action, applets, droplets, the `osascript` command-line tool, the `NSUserScriptTask` API, and everywhere else that other OSA components, such as AppleScript, can be used. This includes Mail rules, Folder Actions, Address Book plug-ins, Calendar alarms, and message triggers.\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW55\"></a>\n>\n> **Note:** The Open Scripting Architecture (OSA) provides a standard and extensible mechanism for interapplication communication in OS X. Communication takes place through the exchange of Apple events, a type of message designed to encapsulate commands and data of any complexity. For information about OSA, see [Open Scripting Architecture](https://developer.apple.com/library/archive/../../documentation/AppleScript/Conceptual/AppleScriptX/Concepts/osa.html#//apple_ref/doc/uid/TP40001571) in *[AppleScript Language Guide](https://developer.apple.com/library/archive/../../documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html#//apple_ref/doc/uid/TP40000983)*.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW4\"></a>\n\n### Scripting Dictionaries\n\nScripting dictionaries detail the object model of applications. Terminology in scripting dictionaries maps to valid JavaScript identifiers by following a set of conventions. The Script Dictionary viewer in Script Editor has been updated to show terminology in AppleScript, JavaScript, and Objective-C (Scripting Bridge framework) formats. To open a scripting dictionary, launch Script Editor (in `/Applications/Utilities/`) and choose File &gt; Open Dictionary or Window &gt; Library.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW5\"></a>\n\n### Object Specifiers\n\nMany objects in the JavaScript for Automation host environment refer to external entities, such as other applications, or windows or data inside of those other applications. When you access a JavaScript property of an application object, or of an element of an application object, a new object specifier is returned that refers to the specific property of that object.\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW56\"></a>\n>\n> **Note:** An object specifier is not the actual value of the external entity's property; it is a reference to the object. To retrieve the value of a referenced property, an additional step is required, described in [Getting and Setting Properties](#//apple_ref/doc/uid/TP40014508-CH109-SW8).\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW6\"></a>\n\n## Accessing Applications\n\nYou can access an application in a number of ways:\n\n* By name\n\n  ```\n  Application('Mail')\n  ```\n* By bundle ID\n\n  ```\n  Application('com.apple.mail')\n  ```\n* By path\n\n  ```\n  Application('/Applications/Mail.app')\n  ```\n* By process ID\n\n  ```\n  Application(763)\n  ```\n* On a remote machine\n\n  ```\n  Application('eppc://127.0.0.1/Mail')\n  ```\n* Accessing the application that is running the script\n\n  ```\n  Application.currentApplication()\n  ```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW7\"></a>\n\n## Syntax Examples\n\nThe following examples demonstrate the syntax for interacting with objects in an application:\n\n* Access properties\n\n  ```\n  Mail.name\n  ```\n* Access elements\n\n  ```\n  Mail.outgoingMessages[0]\n  ```\n* Call commands\n\n  ```\n  Mail.open(...)\n  ```\n* Create new objects\n\n  ```\n  Mail.OutgoingMessage(...)\n  ```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW8\"></a>\n\n## Getting and Setting Properties\n\nYou access properties of scripting objects as JavaScript properties using *dot notation*. As described above, the returned object is an object specifier—a reference to the accessed property—rather than the actual value. To send the `get` event to the external entity and return its value, call the property as a function:\n\n```\nsubject = Mail.inbox.messages[0].subject()\n```\n\nSimilarly, setting a property sends the `set` event to the external entity with the data you want to set.\n\n```\nMail.outgoingMessages[0].subject = 'Hello world'\n```\n\nHere is an example showing how to get a property from every element of an array (in this case, the subject of every message in Mail's inbox).\n\n```\nsubjects = Mail.inbox.messages.subject()\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW9\"></a>\n\n## Element Arrays\n\nYou access elements within an array by calling specific element retrieval methods on the array, or by using square brackets and specifying the name or index of the element you want to retrieve. The returned values are object specifiers, with their own properties and elements, that refer to the array elements. They can be accessed by:\n\n* Index\n\n  ```\n  window = Mail.windows.at(0)\n  window = Mail.windows[0]\n  ```\n* Name\n\n  ```\n  window = Mail.windows.byName('New Message')\n  window = Mail.windows['New Message']\n  ```\n* ID\n\n  ```\n  window = Mail.windows.byId(412)\n  ```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW37\"></a>\n>\n> **Note:** ID access does not have a square bracket shorthand.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW10\"></a>\n\n## Filtering Arrays\n\nTo filter arrays, returning only some of the elements, use the `whose` method. Here is the general syntax.\n\n```\nsomeElementArray.whose({...})\n```\n\nPass in an object containing the query's criteria—element property and value to use for filtering. You can use this technique to check for:\n\n* Literal property matches\n\n  ```\n  { name: 'JavaScript for Automation' }\n  { name: { _equals: 'JavaScript for Automation' } }\n  { name: { '=': 'JavaScript for Automation' } }\n  ```\n* Property matches containing a value\n\n  ```\n  { name: { _contains: 'script for Auto' } }\n  ```\n* Property matches beginning with a value\n\n  ```\n  { name: { _beginsWith: 'JavaScript' } }\n  ```\n* Property matches ending with a value\n\n  ```\n  { name: { _endsWith: 'Automation' } }\n  ```\n* Property matches greater than a value\n\n  ```\n  { size: { _greaterThan: 20 } }\n  { size: { '&gt;': 20 } }\n  ```\n* Property matches greater than or equal to a value\n\n  ```\n  { size: { _greaterThanEquals: 20 } }\n  { size: { '&gt;=': 20 } }\n  ```\n* Property matches less than a value\n\n  ```\n  { size: { _lessThan: 20 } }\n  { size: { '&lt;': 20 } }\n  ```\n* Property matches less than or equal to a value\n\n  ```\n  { size: { _lessThanEquals: 20 } }\n  { size: { '&lt;=': 20 } }\n  ```\n* Subelement property matches\n\n  ```\n  { _match: [ ObjectSpecifier.tabs[0].name, 'Apple' ] }\n  ```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW38\"></a>\n>\n> **Note:** The `_match` key takes an array as its value.\n\nYou can also combine queries in order to determine whether multiple criteria evaluate to `true`.\n\n* All criteria evaluate to `true`.\n\n  ```\n  { _and: [\n      { name: 'Apple' },\n      { size: { '&lt;': 20 } },\n  ]}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW39\"></a>\n  >\n  > **Note:** An object with multiple criteria to match is treated as a logical `and` operator (`&&`).\n  >\n  > The `_and` array requires at least two elements.\n* At least one of the criteria evaluates to `true`.\n\n  ```\n  { _or: [\n      { name: 'Apple' },\n      { name: { _contains: 'JavaScript' } },\n  ]}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW40\"></a>\n  >\n  > **Note:** The `_or` array requires at least two elements.\n* None of the criteria evaluates to `true`.\n\n  ```\n  { _not: [\n      { name: 'Apple' },\n      { name: { _contains: 'JavaScript' } },\n  ]}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW41\"></a>\n  >\n  > **Note:** The `_not` array can have one or more elements.\n\nThe `_and`, `_or`, and `_not` keys require arrays as their value.\n\nHere is an example of a `whose` clause to find all of the messages in your inbox that contain the word *JavaScript* or the word *Automation* in the subject.\n\n```\nMail = Application('Mail')\nMail.inbox.messages.whose({\n    _or: [\n        { subject: { _contains: \"JavaScript\" } },\n        { subject: { _contains: \"Automation\" } }\n    ]\n})\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW11\"></a>\n\n## Calling Commands\n\nCommands are called as functions. Some commands take a direct parameter, which is passed as the first argument to a command. Some commands can take named parameters, accepting an object of keyed values for the named parameters. If the command takes a direct parameter, you pass the object of named parameters as a second argument. If the command has no direct parameter, the object of named parameters is passed as the first and only argument. When the direct parameter is optional, you can pass nothing to the command, or you can pass null as the first parameter if you will pass in named parameters.\n\n* Command with no arguments\n\n  ```\n  message.open()\n  ```\n* Command with direct parameter\n\n  ```\n  Mail.open(message)\n  ```\n* Command with named parameters\n\n  ```\n  response = message.reply({\n      replayAll: true,\n      openingWindow: false\n  })\n  ```\n* Command with direct parameter and named parameters\n\n  ```\n  Safari.doJavaScript('alert(\"Hello world\")', {\n      in: Safari.windows[0].tabs[0]\n  })\n  ```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW12\"></a>\n\n## Creating Objects\n\nYou can create new objects by calling class constructors as functions and optionally providing properties and data. When making an object, you must either call the `make` method on the object, or call the `push` method on an application object array for the object to actually be created. Until you call one of these methods, the object doesn't actually exist in the application.\n\n* Create a new object.\n\n  ```\n  message = Mail.OutgoingMessage().make()\n  ```\n* Create a new object with properties.\n\n  ```\n  message = Mail.OutgoingMessage({\n      subject: 'Hello world',\n      visible: true\n  })\n  Mail.outgoingMessages.push(message)\n  ```\n* Create a new object with data.\n\n  ```\n  para = TextEdit.Paragraph({}, 'Some text')\n  TextEdit.documents[0].paragraphs.push(para)\n  ```\n\nOnce you create a new object in an application (by calling `make` or `push`), you can interact with it like any existing application objects.\n\n```\nmessage = Mail.OutgoingMessage().make()\nmessage.subject = 'Hello world'\n```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW42\"></a>\n>\n> **Note:** Class constructors are title cased.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW13\"></a>\n\n## Scripting Additions\n\nUse scripting additions (plug-ins for scripts) to enhance the functionality of applications. The OS has a set of standard scripting additions that provide the ability to speak text, display user interaction dialogs, and more. To use them, an application must explicitly set the `includeStandardAdditions` flag to `true`.\n\n```\napp = Application.currentApplication()\napp.includeStandardAdditions = true\napp.say('Hello world')\napp.displayDialog('Please enter your email address', {\n    withTitle: 'Email',\n    defaultAnswer: 'your_email@site.com'\n})\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW34\"></a>\n\n## Strict Flags\n\nYou can affect how strictly JavaScript for Automation treats application objects when you:\n\n* Look up properties of objects.\n\n  ```\n  app.strictPropertyScope = true\n  ```\n\n  If the `Foo` class has a property `bar`, but the `Baz` class does not, the following code will only send the proper event to get the property when `strictPropertyScope` is `false`.\n\n  ```\n  app.baz[0].bar()\n  ```\n* Look up commands that objects respond to.\n\n  ```\n  app.strictCommandScope = true\n  ```\n\n  If the application has a command `foo`, but the `Bar` class does not say it responds to that command, the following code will only send the proper command event when `strictCommandScope` is `false`.\n\n  ```\n  app.bar[0].foo()\n  ```\n* Check the types of parameters sent in commands.\n\n  ```\n  app.strictParameterType = true\n  ```\n\n  For example, System Events has a `keystroke` command that accepts text as its first argument. The application's `strictParameterType` property must be `false` for you to be able to send a number instead of a string.\n\nBy default, applications have `strictPropertyScope` and `strictCommandScope` set to `false` and `strictParameterType` set to `true`.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW36\"></a>\n\n## Passing Event Modifiers\n\nYou can pass event modifiers when getting and setting properties, calling commands on objects, creating new objects in applications, and so on. The event modifiers should be passed as the last argument to whatever function you are calling. Here are some examples:\n\n* Call a command with a timeout—the amount of time a script allows for a single event to execute.\n\n  ```\n  TextEdit = Application('TextEdit')\n  doc = TextEdit.documents[0]\n  doc.close({ saving: 'ask' }, { timeout: 20 })\n  ```\n* Call a `whose` method while ignoring case, but considering white space and hyphens.\n\n  ```\n  app.documents.whose({\n      text: { _contains: 'custom-built automation' }\n  }, {\n      ignoring: 'case',\n      considering: ['white space', 'hyphens']\n  })\n  ```\n\nYou can consider or ignore:\n\n* Case\n* Diacriticals\n* White space\n* Hyphens\n* Punctuation\n* Numeric strings\n* Application responses\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW57\"></a>\n>\n> **Note:** If a function has named parameters, as seen in the `close` function in the timeout example above, the event modifiers must follow a named parameters object. If the function’s named parameters are optional, the named parameters object is still required, even if it’s empty.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW33\"></a>\n\n## ObjectSpecifier\n\nYou can use the `ObjectSpecifier` object to:\n\n* Check whether an object is an object specifier\n\n  ```\n  Mail.inbox.messages[0] instanceof ObjectSpecifier == true\n  ```\n* Get the class of an object specifier\n\n  ```\n  Mail = Application('Mail')\n  ObjectSpecifier.classOf(Mail.inbox)\n  ```\n* Build arbitrary object specifier chains for use in whose clauses\n\n  ```\n  firstTabsName = ObjectSpecifier.tabs[0].name\n  app.windows.whose({\n      _match: [firstTabsName, 'Apple']\n  })\n  ```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW31\"></a>\n\n## Paths\n\nWhen you need to interact with files, such as a document in TextEdit, you will need a `path` object, not just a string with a path in it. You can use the `Path` constructor to instantiate paths.\n\n```\nTextEdit = Application('TextEdit')\npath = Path('/Users/username/Desktop/foo.rtf')\nTextEdit.open(path)\n```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW43\"></a>\n>\n> **Note:** Get the string value of the `Path` by calling the `toString` method.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW35\"></a>\n\n## Progress\n\nYou can interact with a script's `Progress` object to affect the UI that details the script's progress. You can set the object’s:\n\n* Total unit count\n\n  ```\n  Progress.totalUnitCount = 10\n  ```\n* Completed unit count\n\n  ```\n  Progress.completedUnitCount = 1\n  ```\n* Description\n\n  ```\n  Progress.description = 'Processing Files'\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW44\"></a>\n  >\n  > **Note:** Setting the description of the progress object will replace the \"Running...\" text that appears by default.\n* Additional description\n\n  ```\n  Progress.additionalDescription = 'This may take a little while'\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW45\"></a>\n  >\n  > **Note:** Setting the additional description of the progress object means the total unit count and completed unit count will not be shown.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW14\"></a>\n\n## Libraries\n\nTo use scripts as libraries, store them in `~/Library/Script Libraries/`.\n\nSuppose you have a script library named `toolbox.scpt`, which contains the following code:\n\n```\nfunction log(message) {\n    TextEdit = Application('TextEdit')\n    doc = TextEdit.documents['Log.rtf']\n    doc.text = message\n}\n```\n\nAnother script can target methods in your library using the following syntax.\n\n```\ntoolbox = Library('toolbox')\ntoolbox.log('Hello world')\n```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW46\"></a>\n>\n> **Note:** Any code outside of functions in a library will be executed when the library is instantiated.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW15\"></a>\n\n## Applets\n\nYou can make standalone, double-clickable applications (called applets) by writing a script in Script Editor and saving it as an application. Applets support the following event handlers:\n\n* A `run` event handler is called when the applet runs.\n\n  ```\n  function run() {...}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW47\"></a>\n  >\n  > **Note:** Unless explicitly defined, this handler is implied in a script and any code outside of a function is executed when the applet runs.\n* An `openDocuments` event handler’s inclusion configures the applet to operate as a droplet. This handler is called when documents are dropped onto the applet.\n\n  ```\n  function openDocuments(docs) {...}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW58\"></a>\n  >\n  > **Note:** The argument passed to the `openDocuments` handler is an array of file path strings.\n* A `printDocuments` handler is called when the applet is told to print documents.\n\n  ```\n  function printDocuments(docs) {...}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW48\"></a>\n  >\n  > **Note:** The argument passed to the `printDocuments` handler is an array of file path strings.\n* An `idle` handler is called periodically when the script enters an idle period. This handler allows you to do periodic processing.\n\n  ```\n  function idle() {...}\n  ```\n* A `reopen` handler is called when the applet is reopened.\n\n  ```\n  function reopen() {...}\n  ```\n* A `quit` handler is called when the applet is quit.\n\n  ```\n  function quit() {...}\n  ```\n\n  > <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW49\"></a>\n  >\n  > **Note:** Returning `false` from the quit handler is the only way to prevent an applet from quitting. Having no quit handler or returning any value other than `false` (including not returning a value) causes the applet to quit as it normally would.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW16\"></a>\n\n## UI Automation\n\nYou can automate the user interfaces of applications by scripting the System Events application. Explore the scripting dictionary of System Events in Script Editor—specifically the Processes Suite—to see a list of application interface elements that support this type of automation.\n\nThe following example uses UI scripting to create a new note in Notes.\n\n```\nNotes = Application('Notes')\nNotes.activate()\n \ndelay(1)\nSystemEvents = Application('System Events')\nNotes = SystemEvents.processes['Notes']\n \nNotes.windows[0].splitterGroups[0].groups[1].groups[0].buttons[0].click()\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW17\"></a>\n\n## Objective-C Bridge\n\nJavaScript for Automation has a built-in Objective-C bridge that enables you to access the file system and build Cocoa applications.\n\nThe primary access points for the Objective-C bridge are the global properties `ObjC` and `$`.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW18\"></a>\n\n### Frameworks\n\nThe symbols from the Foundation framework are available by default in JavaScript for Automation. You can make additional frameworks and libraries available using the `ObjC.import()` method. For example, to use the `NSBeep()` function, which is not present in Foundation, you can import the Cocoa framework.\n\n```\nObjC.import('Cocoa')\n$.NSBeep()\n```\n\nIn addition to system frameworks, functionality from some of the system libraries has been exposed. This functionality can be imported by referring to the name of the header file (without the `.h`) that declares that functionality, such as `arpa/inet`, `asl`, `copyfile`, `dispatch`, `dyld`, `errno`, `getopt`, `glob`, `grp`, `ifaddrs`, `launch`, `membership`, `netdb`, `netinet/in`, `notify`, `objc`, `paths`, `pwd`, `readline`, `removefile`, `signal`, `spawn`, `sqlite3`, `stdio`, `stdlib`, `string`, `sys/fcntl`, `sys/file`, `sys/ioctl`, `sys/mount`, `sys/param`, `sys/resource`, `sys/socket`, `sys/stat`, `sys/sysctl`, `sys/time`, `sys/times`, `sys/types`, `sys/wait`, `sys/xattr`, `syslog`, `time`, `unistd`, `uuid/uuid`, `vImage`, `vecLib`, `vmnet`, `xpc`, and `zlib`.\n\nWhen you import frameworks, the system consults bridge support files. In addition to built-in frameworks and libraries, you can import any framework that has bridge support by passing the full path to the framework, as in the following example:\n\n```\nObjC.import('/Library/Frameworks/Awesome.framework')\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW19\"></a>\n\n### Data Types\n\nThe primitive JavaScript data types are mapped to C data types. For example, a JavaScript string maps to `char *`, while a JavaScript integer maps to `int`. When using an ObjC API that returns a `char *`, you'll get a JS string.\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW50\"></a>\n>\n> **Note:** Longs will be converted to strings in JavaScript.\n\nPrimitive JavaScript data types will be automatically converted to ObjC object types when passed as an argument to an ObjC method that is expecting an object type. For example, a JS string will be converted to an `NSString` object if that is what the method signature says the argument should be typed as.\n\nNote, however, that ObjC object types that are returned by ObjC methods are never automatically converted to primitive JavaScript data types.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW20\"></a>\n\n### Instantiating Classes and Invoking Methods\n\nAll classes are defined as properties of the `$` object. Methods of ObjC objects are invoked in one of two ways, depending on whether the method takes arguments.\n\nIf the ObjC method does not take arguments, then you invoke it by accessing the JavaScript property with that name. This example instantiates an empty mutable string.\n\n```\nstr = $.NSMutableString.alloc.init\n```\n\nIf the ObjC method does take arguments, then you invoke it by calling the JavaScript method (function-typed property) named according to the JSExport convention; the letter following each \":\" is capitalized, and then the \":\"s are removed. This example instantiates an `NSString` from a JavaScript string and writes it to a file.\n\n```\nstr = $.NSString.alloc.initWithUTF8String('foo')\nstr.writeToFileAtomically('/tmp/foo', true)\n```\n\nIf you call a method, such as `-intValue`, that returns a C data type rather than an object, then you'll get back a primitive JavaScript data type. This example returns the primitive JavaScript integer, `99`.\n\n```\n$.NSNumber.numberWithInt(99).intValue\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW21\"></a>\n\n### Accessing ObjC Properties\n\nObjC properties are also accessed through JavaScript properties, similar to how you invoke methods that don’t have arguments.\n\nWhen a property of a bridged object is accessed, the list of ObjC properties is first consulted, and if a property with that name exists, then the appropriate getter or setter selector for that property is used. If an ObjC property with that name does not exist on the class, then the property name is used as the method selector.\n\nTo define a property using a custom getter name, you can use either the property name or the getter name, and get the same result.\n\n```\ntask = $.NSTask.alloc.init\ntask.running == task.isRunning\n```\n\nAlso, unlike argument-less methods, bridged object properties that map to ObjC properties can also be set to (assuming the property is read/write). The following two lines are equivalent because `launchPath` is defined as an ObjC property.\n\n```\ntask.launchPath = '/bin/sleep'\ntask.setLaunchPath('/bin/sleep')\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW22\"></a>\n\n### Wrapping and Unwrapping\n\nThe `ObjC.wrap()` method can be used convert a primitive JavaScript data type into an ObjC object type, and then wrap that ObjC object in a JavaScript wrapper.\n\nThe `ObjC.unwrap()` method can be used to convert a wrapped ObjC object into a primitive JavaScript data type.\n\nThe `ObjC.deepUnwrap()` method can be used to recursively convert a wrapped ObjC object into a primitive JavaScript data type.\n\nThe `$()` operator is a convenient alias for `ObjC.wrap()`, and is meant to be similar to the `@()` boxing operator in ObjC. For example, `$(\"foo\")` returns a wrapped `NSString` instance, and `$(1)` returns a wrapped `NSNumber` instance.\n\nThe `.js` property of wrapped ObjC objects is a convenient alias for `ObjC.unwrap()`. For example, `$(\"foo\").js` returns \"foo\".\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW23\"></a>\n\n### Constants and Enumerations\n\nConstants and enums are defined as properties of the `$` object.\n\n```\n$.NSNotFound\n$.NSFileReadNoSuchFileError\n$.NSZeroRect\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW24\"></a>\n\n### Functions\n\nFunctions are also defined as properties of the `$` object.\n\n```\n$.NSBeep()\n$.NSMakeSize(33, 55)\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW51\"></a>\n\n### Variadics\n\nWhen you use functions and methods that accept variadic arguments, every variable argument passed in must be the same type as the last declared parameter. For example, `printf` must receive `%s` arguments after the initial format string.\n\n```\nObjC.import('stdio')\n$.printf('%s %s %s', 'JavaScript', 'for', 'Automation')\n```\n\n`NSLog` has a final declared parameter type of `%@` and must receive `%@` arguments after the initial format string.\n\n```\n$.NSLog('%@ %@ %@', $('JavaScript'), $('for'), $('Automation'))\n```\n\nWhen you create an `NSArray` using `arrayWithObjects`, nil termination is handled for you. Don’t try to terminate it yourself.\n\n```\n$.NSArray.arrayWithObjects($('JavaScript'), $('for'), $('Automation'))\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW25\"></a>\n\n### Structs\n\nStructs are represented as generic JavaScript objects, where the struct field names are the property names.\n\n```\n$.NSMakeRect(0, 0, 1024, 768)\n```\n\nResult: {\"origin\":{\"x\":0,\"y\":0},\"size\":{\"width\":1024,\"height\":768}}\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW26\"></a>\n\n### Nil\n\nIn ObjC, `nil` is a valid message target. Sending a message to a `nil` object returns `nil` again. This behavior is different in JavaScript, which does not allow methods to be called on `undefined`.\n\nTo create a JavaScript object that represents `nil`, call the `$()` function with no arguments.\n\n```\nnil = $()\n```\n\nTo determine if a bridged object is actually wrapping a `nil` pointer, you can call the `isNil()` method.\n\n```\nif (o.isNil()) { ... }\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW27\"></a>\n\n### Implicit Pass-by-Reference\n\nThis boxed `nil` can be passed as an argument to an ObjC method that expects an argument passed by reference; the runtime will automatically replace the inner `nil` pointer with the pointer returned by reference.\n\n```\nerror = $()\nfm = $.NSFileManager.defaultManager\nfm.attributesOfItemAtPathError('/DOES_NOT_EXIST', error)\nif (error.code == $.NSFileReadNoSuchFileError) {\n    // ...\n}\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW28\"></a>\n\n### Explicit Pass-by-Reference\n\nThe `Ref` class can be used to pass arguments that ObjC expects to be passed by reference. The referenced value can be retrieved by accessing the `0` property of the `Ref`.\n\n```\nfunction testExplicitPassByReference(path) {\n    ref = Ref()\n    fm = $.NSFileManager.defaultManager\n    exists = fm.fileExistsAtPathIsDirectory(path, ref)\n    if (exists) {\n        isDirectory = ref[0]\n        return (path + ' is ' + (isDirectory ? '' : 'not ') + 'a directory; ')\n    }\n    else {\n        return (path + ' does not exist\\\\n')\n    }\n}\n \noutput = testExplicitPassByReference('/System')\n       + testExplicitPassByReference('/mach_kernel')\n       + testExplicitPassByReference('/foo')\n```\n\nResult: /System is a directory; /mach\\_kernel is not a directory; /foo does not exist\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW52\"></a>\n\n### Ref\n\nTo access the byte values of `Ref` objects, index them into like arrays.\n\n```\nref = Ref('id*')\nref[0] = $('foo')\nif (ref[0] == $('foo')) { ... }\n```\n\nWhen you need to pass an opaque pointer and check whether you got that opaque pointer back, you instantiate a void `Ref` and use the `equals` method.\n\n```\nCONTEXT = Ref('void')\n \nObjC.registerSubclass({\n    name: 'MyObject',\n    properties: { foo: 'id' },\n    methods: {\n        'startObserving': {\n            types: ['void', []],\n            implementation: function (obj) {\n                this.addObserverForKeyPathOptionsContext(\n                    this,\n                    'foo',\n                    ($.NSKeyValueObservingOptionNew | $.NSKeyValueObservingOptionOld),\n                    CONTEXT\n                );\n            },\n        },\n        'observeValueForKeyPath:ofObject:change:context:': {\n            types: ['void', ['id', 'id', 'id', 'void *']],\n            implementation: function(keyPath, observedObject, change, context) {\n                $.NSLog(Automation.getDisplayString(Ref.equals(context, CONTEXT)))\n            }\n        }\n    }\n})\n```\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW29\"></a>\n\n### Function Binding\n\nWhen frameworks are imported, only the C functions specified in the bridge support files are made available. To access other C functions that are linked into the host application, a script may bind them into the JavaScript environment. Call the `bindFunction()` method and specify the return and argument types of the function.\n\n```\nObjC.bindFunction('pow', ['double', ['double', 'double']])\n$.pow(2,10)\n```\n\nResult: 1024\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW32\"></a>\n\n### Types\n\nHere are some of the allowed strings for specifying types of properties, method and function arguments, and return values: `void`, `bool`, `float`, `double`, `unsigned char`, `char`, `unsigned short`, `short`, `unsigned int`, `int`, `unsigned long`, `long`, `long double`, `class`, `selector`, `string`, `pointer`, `block`, `function`, and `id`.\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW53\"></a>\n>\n> **Note:** Struct type names, such as `NSRect`, are allowed, but `id` must be used for objects, not actual class names.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW30\"></a>\n\n### Subclassing\n\nSubclasses of Objective-C objects can be registered from JavaScript.\n\n```\nObjC.registerSubclass({\n    name: 'AppDelegate',\n    superclass: 'NSObject',\n    protocols: ['NSApplicationDelegate'],\n    properties: {\n        window: 'id'\n    },\n    methods: {\n        'applicationDidFinishLaunching:': function (notification) {\n            $.NSLog('Application finished launching');\n        }\n    }\n})\n```\n\nIf no superclass is given, the object will implicitly subclass `NSObject`. When you override a method, specifying the method types is optional, but if the types are present, they must match those of the superclass's method.\n\nHere is an example of a custom `init` method and a custom method with its types declared.\n\n```\nObjC.registerSubclass({\n    name: 'MyClass',\n    properties: {\n        foo: 'id'\n    },\n    methods: {\n        init: function () {\n            var _this = ObjC.super(this).init;\n            if (_this != undefined) {\n                _this.foo = 'bar'\n            }\n            return _this\n        },\n        baz: {\n            types: ['void', []],\n            implementation: function () {\n                this.foo = 'quux'\n            }\n        }\n    }\n})\n```\n\n> <a id=\"//apple_ref/doc/uid/TP40014508-CH109-DontLinkElementID_3\"></a>\n>\n> **Important:** DO NOT assign values to the `this` variable or any of its properties in `init` methods. Instead, use different variables (`_this` is used above) to initialize and return properties. In all other methods, use the standard `this` variable. In JavaScript, you are not allowed to reassign the `this` variable. Objective-C classes are allowed to return from their `init` methods a different object than that on which the method was called.\n\n<a id=\"//apple_ref/doc/uid/TP40014508-CH109-SW54\"></a>\n\n## Automation.getDisplayString()\n\nThe `Automation` object has a `getDisplayString` method that allows you to pass in an object and print it as source text or a human-readable display string.\n\n```\nfoo = $('bar')\nAutomation.getDisplayString(foo)\n```\n\nPassing in `true` as the second parameter to `getDisplayString` will print the object as a display string instead of source text.\n\n```\nAutomation.getDisplayString(foo, true)\n```\n\n  \n\n---\n\nCopyright © 2015 Apple Inc. All Rights Reserved. [Terms of Use](http://www.apple.com/legal/internet-services/terms/site.html) | [Privacy Policy](http://www.apple.com/privacy/) | Updated: 2015-09-16\n",
  "binary": false,
  "source_url": "https://developer.apple.com/library/archive/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/Articles/OSX10-10.html",
  "sha256": "47ba05fada225b77f9efbb0b266fb486db5a5dbb00587d51db7ac08ac7e13687",
  "etag": null,
  "last_modified": null
}
