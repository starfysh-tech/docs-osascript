Prompting for Files or Folders

It’s generally good practice to avoid hard-coding file and folder paths in a script. Prompting the user to select files and folders makes for a more dynamic script that won’t break when paths change.

Prompting for a File

Use the Standard Additions scripting addition’s
choose file
 command to prompt the user to select a file. Listing 26-1 and Listing 26-2 demonstrate how to use this command to display the simple file selection dialog with a custom prompt shown in Figure 26-1.

Figure 26-1
Prompting for a file

APPLESCRIPT

Open in Script Editor

Listing 26-1
AppleScript: Prompting for a file

set theDocument to choose file with prompt "Please select a document to process:"

--&gt; Result: alias "Macintosh HD:Users:yourUserName:Documents:ImportantDoc.pages"

JAVASCRIPT

Open in Script Editor

Listing 26-2
JavaScript: Prompting for a file

var app = Application.currentApplication()

app.includeStandardAdditions = true

var document = app.chooseFile({

withPrompt: "Please select a document to process:"

})

document

// Result: Path("/Users/yourUserName/Documents/ImportantDoc.pages")

Prompting for a Specific Type of File

If your script requires specific types of files for processing, you can use the
choose file
 command’s optional
of type
 parameter to provide a list of acceptable types. Types may be specified as extension strings without the leading period (such as
"jpg"
 or
"png"
) or as uniform type identifiers (such as
"public.image"
 or
"com.apple.iwork.pages.sffpages"
). Listing 26-3 and Listing 26-4 show how to prompt for an image.

APPLESCRIPT

Open in Script Editor

Listing 26-3
AppleScript: Prompting for an image

set theImage to choose file with prompt "Please select an image to process:" of type {"public.image"}

--&gt; Result: alias "Macintosh HD:Users:yourUserName:Pictures:IMG_0024.jpg"

JAVASCRIPT

Open in Script Editor

Listing 26-4
JavaScript: Prompting for an image

var app = Application.currentApplication()

app.includeStandardAdditions = true

var image = app.chooseFile({

withPrompt: "Please select an image to process:",

ofType: ["public.image"]

})

image

// Result: Path("/Users/yourUserName/Pictures/IMG_0024.jpg")

Prompting for Multiple Files

To let the user choose more than one file, include the
choose file
 command’s optional
multiple selections allowed
 parameter. Listing 26-5 and Listing 26-6 display a prompt asking for multiple images, as shown in Figure 26-2.

Figure 26-2
Prompting for multiple images

APPLESCRIPT

Open in Script Editor

Listing 26-5
AppleScript: Prompting for multiple images

set theImages to choose file with prompt "Please select some images to process:" of type {"public.image"} with multiple selections allowed

--&gt; Result: {alias "Macintosh HD:Users:yourUserName:Pictures:IMG_0024.jpg", alias "Macintosh HD:Users:yourUserName:Pictures:IMG_0025.jpg", alias "Macintosh HD:Users:yourUserName:Pictures:IMG_0026.jpg"}

JAVASCRIPT

Open in Script Editor

Listing 26-6
JavaScript: Prompting for multiple images

var app = Application.currentApplication()

app.includeStandardAdditions = true

var images = app.chooseFile({

withPrompt: "Please select some images to process:",

ofType: ["public.image"],

multipleSelectionsAllowed: true

})

images

// Result: [Path("/Users/yourUserName/Pictures/IMG_0024.jpg"), Path("/Users/yourUserName/Pictures/IMG_0025.jpg"), Path("/Users/yourUserName/Pictures/IMG_0026.jpg")]

Prompting for a Folder

Use the Standard Additions scripting addition’s
choose folder
 command to prompt the user to select a folder, such as an output folder or folder of images to process. Listing 26-7 and Listing 26-8 demonstrate how to use this command to display the simple folder selection dialog with a custom prompt shown in Figure 26-3.

Figure 26-3
Prompting for a folder

APPLESCRIPT

Open in Script Editor

Listing 26-7
AppleScript: Prompting for a folder

set theOutputFolder to choose folder with prompt "Please select an output folder:"

--&gt; Result: alias "Macintosh HD:Users:yourUserName:Desktop:"

JAVASCRIPT

Open in Script Editor

Listing 26-8
JavaScript: Prompting for a folder

var app = Application.currentApplication()

app.includeStandardAdditions = true

var outputFolder = app.chooseFolder({

withPrompt: "Please select an output folder:"

})

outputFolder

// Result: Path("/Users/yourUserName/Desktop")

Prompting for Multiple Folders

To let the user choose more than one folder, include the
choose folder
 command’s optional
multiple selections allowed
 parameter, as shown in Listing 26-9 and Listing 26-10.

APPLESCRIPT

Open in Script Editor

Listing 26-9
AppleScript: Prompting for multiple folders

set theFoldersToProcess to choose folder with prompt "Please select the folders containing images to process:" with multiple selections allowed

--&gt; Result: {alias "Macintosh HD:Users:yourUserName:Desktop:", alias "Macintosh HD:Users:yourUserName:Documents:"}

JAVASCRIPT

Open in Script Editor

Listing 26-10
JavaScript: Prompting for multiple folders

var app = Application.currentApplication()

app.includeStandardAdditions = true

var foldersToProcess = app.chooseFolder({

withPrompt: "Please select an output folder:",

multipleSelectionsAllowed: true

})

foldersToProcess

// Result: [Path("/Users/yourUserName/Desktop"), Path("/Users/yourUserName/Documents")]
