{
  "collection": "mac-automation-scripting-guide",
  "path": "PromptforaFileorFolder.md",
  "title": "Prompting for Files or Folders",
  "body": "<a id=\"//apple_ref/doc/uid/TP40016239-CH81\"></a><a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW1\"></a>\n\n## Prompting for Files or Folders\n\nIt’s generally good practice to avoid hard-coding file and folder paths in a script. Prompting the user to select files and folders makes for a more dynamic script that won’t break when paths change.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW16\"></a>\n\n### Prompting for a File\n\nUse the Standard Additions scripting addition’s `choose file` command to prompt the user to select a file. Listing 26-1 and Listing 26-2 demonstrate how to use this command to display the simple file selection dialog with a custom prompt shown in Figure 26-1.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW4\"></a>\n**Figure 26-1**Prompting for a file\n![image: ../Art/choosefile_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/choosefile_2x.png)\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=set%20theDocument%20to%20choose%20file%20with%20prompt%20%22Please%20select%20a%20document%20to%20process%3A%22)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW3\"></a>\n**Listing 26-1**AppleScript: Prompting for a file\n\n1. `set theDocument to choose file with prompt \"Please select a document to process:\"`\n2. `--&gt; Result: alias \"Macintosh HD:Users:yourUserName:Documents:ImportantDoc.pages\"`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Avar%20document%20%3D%20app.chooseFile%28%7B%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20a%20document%20to%20process%3A%22%0A%7D%29%0Adocument%0A)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW5\"></a>\n**Listing 26-2**JavaScript: Prompting for a file\n\n1. `var app = Application.currentApplication()`\n2. `app.includeStandardAdditions = true`\n4. `var document = app.chooseFile({`\n5. ` withPrompt: \"Please select a document to process:\"`\n6. `})`\n7. `document`\n8. `// Result: Path(\"/Users/yourUserName/Documents/ImportantDoc.pages\")`\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW17\"></a>\n\n### Prompting for a Specific Type of File\n\nIf your script requires specific types of files for processing, you can use the `choose file` command’s optional `of type` parameter to provide a list of acceptable types. Types may be specified as extension strings without the leading period (such as `\"jpg\"` or `\"png\"`) or as uniform type identifiers (such as `\"public.image\"` or `\"com.apple.iwork.pages.sffpages\"`). Listing 26-3 and Listing 26-4 show how to prompt for an image.\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=set%20theImage%20to%20choose%20file%20with%20prompt%20%22Please%20select%20an%20image%20to%20process%3A%22%20of%20type%20%7B%22public.image%22%7D)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW6\"></a>\n**Listing 26-3**AppleScript: Prompting for an image\n\n1. `set theImage to choose file with prompt \"Please select an image to process:\" of type {\"public.image\"}`\n2. `--&gt; Result: alias \"Macintosh HD:Users:yourUserName:Pictures:IMG_0024.jpg\"`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Avar%20image%20%3D%20app.chooseFile%28%7B%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20an%20image%20to%20process%3A%22%2C%0A%20%20%20%20ofType%3A%20%5B%22public.image%22%5D%0A%7D%29%0Aimage)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW7\"></a>\n**Listing 26-4**JavaScript: Prompting for an image\n\n1. `var app = Application.currentApplication()`\n2. `app.includeStandardAdditions = true`\n4. `var image = app.chooseFile({`\n5. ` withPrompt: \"Please select an image to process:\",`\n6. ` ofType: [\"public.image\"]`\n7. `})`\n8. `image`\n9. `// Result: Path(\"/Users/yourUserName/Pictures/IMG_0024.jpg\")`\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW18\"></a>\n\n### Prompting for Multiple Files\n\nTo let the user choose more than one file, include the `choose file` command’s optional `multiple selections allowed` parameter. Listing 26-5 and Listing 26-6 display a prompt asking for multiple images, as shown in Figure 26-2.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW10\"></a>\n**Figure 26-2**Prompting for multiple images\n![image: ../Art/chooseimages_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/chooseimages_2x.png)\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=set%20theImages%20to%20choose%20file%20with%20prompt%20%22Please%20select%20some%20images%20to%20process%3A%22%20of%20type%20%7B%22public.image%22%7D%20with%20multiple%20selections%20allowed)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW8\"></a>\n**Listing 26-5**AppleScript: Prompting for multiple images\n\n1. `set theImages to choose file with prompt \"Please select some images to process:\" of type {\"public.image\"} with multiple selections allowed`\n2. `--&gt; Result: {alias \"Macintosh HD:Users:yourUserName:Pictures:IMG_0024.jpg\", alias \"Macintosh HD:Users:yourUserName:Pictures:IMG_0025.jpg\", alias \"Macintosh HD:Users:yourUserName:Pictures:IMG_0026.jpg\"}`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Avar%20images%20%3D%20app.chooseFile%28%7B%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20some%20images%20to%20process%3A%22%2C%0A%20%20%20%20ofType%3A%20%5B%22public.image%22%5D%2C%0A%20%20%20%20multipleSelectionsAllowed%3A%20true%0A%7D%29%0Aimages)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW9\"></a>\n**Listing 26-6**JavaScript: Prompting for multiple images\n\n1. `var app = Application.currentApplication()`\n2. `app.includeStandardAdditions = true`\n4. `var images = app.chooseFile({`\n5. ` withPrompt: \"Please select some images to process:\",`\n6. ` ofType: [\"public.image\"],`\n7. ` multipleSelectionsAllowed: true`\n8. `})`\n9. `images`\n10. `// Result: [Path(\"/Users/yourUserName/Pictures/IMG_0024.jpg\"), Path(\"/Users/yourUserName/Pictures/IMG_0025.jpg\"), Path(\"/Users/yourUserName/Pictures/IMG_0026.jpg\")]`\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW2\"></a>\n\n### Prompting for a Folder\n\nUse the Standard Additions scripting addition’s `choose folder` command to prompt the user to select a folder, such as an output folder or folder of images to process. Listing 26-7 and Listing 26-8 demonstrate how to use this command to display the simple folder selection dialog with a custom prompt shown in Figure 26-3.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW13\"></a>\n**Figure 26-3**Prompting for a folder\n![image: ../Art/choosefolder_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/choosefolder_2x.png)\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=set%20theOutputFolder%20to%20choose%20folder%20with%20prompt%20%22Please%20select%20an%20output%20folder%3A%22)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW11\"></a>\n**Listing 26-7**AppleScript: Prompting for a folder\n\n1. `set theOutputFolder to choose folder with prompt \"Please select an output folder:\"`\n2. `--&gt; Result: alias \"Macintosh HD:Users:yourUserName:Desktop:\"`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Avar%20outputFolder%20%3D%20app.chooseFolder%28%7B%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20an%20output%20folder%3A%22%0A%7D%29%0AoutputFolder)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW12\"></a>\n**Listing 26-8**JavaScript: Prompting for a folder\n\n1. `var app = Application.currentApplication()`\n2. `app.includeStandardAdditions = true`\n4. `var outputFolder = app.chooseFolder({`\n5. ` withPrompt: \"Please select an output folder:\"`\n6. `})`\n7. `outputFolder`\n8. `// Result: Path(\"/Users/yourUserName/Desktop\")`\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW19\"></a>\n\n### Prompting for Multiple Folders\n\nTo let the user choose more than one folder, include the `choose folder` command’s optional `multiple selections allowed` parameter, as shown in Listing 26-9 and Listing 26-10.\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=set%20theFoldersToProcess%20to%20choose%20folder%20with%20prompt%20%22Please%20select%20the%20folders%20containing%20images%20to%20process%3A%22%20with%20multiple%20selections%20allowed)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW14\"></a>\n**Listing 26-9**AppleScript: Prompting for multiple folders\n\n1. `set theFoldersToProcess to choose folder with prompt \"Please select the folders containing images to process:\" with multiple selections allowed`\n2. `--&gt; Result: {alias \"Macintosh HD:Users:yourUserName:Desktop:\", alias \"Macintosh HD:Users:yourUserName:Documents:\"}`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&script=var%20app%20%3D%20Application.currentApplication%28%29%0Aapp.includeStandardAdditions%20%3D%20true%0A%0Avar%20foldersToProcess%20%3D%20app.chooseFolder%28%7B%0A%20%20%20%20withPrompt%3A%20%22Please%20select%20an%20output%20folder%3A%22%2C%0A%20%20%20%20multipleSelectionsAllowed%3A%20true%0A%7D%29%0AfoldersToProcess)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH81-SW15\"></a>\n**Listing 26-10**JavaScript: Prompting for multiple folders\n\n1. `var app = Application.currentApplication()`\n2. `app.includeStandardAdditions = true`\n4. `var foldersToProcess = app.chooseFolder({`\n5. ` withPrompt: \"Please select an output folder:\",`\n6. ` multipleSelectionsAllowed: true`\n7. `})`\n8. `foldersToProcess`\n9. `// Result: [Path(\"/Users/yourUserName/Desktop\"), Path(\"/Users/yourUserName/Documents\")]`\n",
  "binary": false,
  "source_url": "https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/PromptforaFileorFolder.html",
  "sha256": "99c39515508fa9b9da1e12fbf9ee0fcd936a9e396825185333e5c21602e041c8",
  "etag": null,
  "last_modified": null
}
