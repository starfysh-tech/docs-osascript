{
  "collection": "mac-automation-scripting-guide",
  "path": "MakeaSystem-WideService.md",
  "title": "Making a Systemwide Service",
  "body": "<a id=\"//apple_ref/doc/uid/TP40016239-CH46\"></a><a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW1\"></a>\n<a id=\"//apple_ref/doc/uid/TP40016239-CH68\"></a><a id=\"//apple_ref/doc/uid/TP40016239-CH68-SW1\"></a>\n\n## Making a Systemwide Service\n\nIn OS X, *services* let you access functionality in one app from within another app. An app that provides a service advertises the operations it can perform on a particular type of data. Services are triggered from the Application Name &gt; Services menu, or from contextual menus that appear when you Control-click on text, files, and other kinds of data. When you’re manipulating a particular type of data, related services becomes available. For example, Mail provides a service that creates a new email from selected text.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW9\"></a>\n\n### Making a Script Available as a Service\n\nA script can be made available as a service by embedding it in an Automator service workflow.\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW10\"></a>\n\n**To create a service workflow that runs a script**\n\n1. Launch Automator, found in `/Applications/`.\n2. Create a new Automator document.\n3. When prompted, choose a document type of Service and click Choose.\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW4\"></a>\n\n   ![image: ../Art/automator_template_window_servicesselected_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_template_window_servicesselected_2x.png)\n4. At the top of the Automator document, configure the service.\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW5\"></a>\n\n   ![image: ../Art/automator_workflow_document_serviceoptions_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_workflow_document_serviceoptions_2x.png)\n\n   If the service will process a specific type of data, such as text, files, or images, select the appropriate type. Otherwise, select “no input.”\n\n   If the service will be available within the context of a specific app only, select the appropriate app. Otherwise, select “any application.”\n\n   If the service will replace selected text with processed text, select the “Output replaces selected text” checkbox.\n5. Type `run` in the search field above the action library pane to filter the action library.\n\n   A list of actions for running AppleScripts, JavaScripts, UNIX shell scripts, and more are displayed.\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW6\"></a>\n\n   ![image: ../Art/automator_runscriptactions_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_runscriptactions_2x.png)\n6. Drag an action, such as Run AppleScript or Run JavaScript, to the workflow area.\n\n   An interface for the action appears.\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW7\"></a>\n\n   ![image: ../Art/automator_workflow_runapplescriptaction_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_workflow_runapplescriptaction_2x.png)\n7. Write the script code and add it to the action. If the action contains additional configuration options, adjust them as needed.\n\n   For AppleScripts and JavaScripts, use the action’s run handler template to process input data when the service runs, such as text or files. For workflows that replace selected text with processed text, be sure your workflow results in a text value. See [Example Service Workflow Scripts](#//apple_ref/doc/uid/TP40016239-CH46-SW12).\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW8\"></a>\n\n   ![image: ../Art/automator_runapplexcript_textprocessingserviceexample_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_runapplexcript_textprocessingserviceexample_2x.png)\n8. Save the Automator document.\n\n   When prompted, enter a name for the service.\n\n   <a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW11\"></a>\n\n   ![image: ../Art/automator_saveservice_dialog_2x.png](https://developer.apple.com/library/archive/mac-automation-scripting-guide/Art/automator_saveservice_dialog_2x.png)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW12\"></a>\n\n### Example Service Workflow Scripts\n\nListing 40-1 and Listing 40-2 provide example code that can be pasted into the Run AppleScript and Run JavaScript Automator actions to convert selected text to uppercase.\n\n**APPLESCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&name=Convert%20Text%20to%20Uppercase&script=on%20run%20%7Binput%2C%20parameters%7D%0D%20%20%20%20set%20input%20to%20changeCaseOfText%28input%20as%20string%2C%20%22upper%22%29%0D%20%20%20%20return%20input%0Dend%20run%0D%0Don%20changeCaseOfText%28theText%2C%20theCaseToSwitchTo%29%0D%20%20%20%20if%20theCaseToSwitchTo%20contains%20%22lower%22%20then%0D%20%20%20%20%20%20%20%20set%20theComparisonCharacters%20to%20%22ABCDEFGHIJKLMNOPQRSTUVWXYZ%22%0D%20%20%20%20%20%20%20%20set%20theSourceCharacters%20to%20%22abcdefghijklmnopqrstuvwxyz%22%0D%20%20%20%20else%20if%20theCaseToSwitchTo%20contains%20%22upper%22%20then%0D%20%20%20%20%20%20%20%20set%20theComparisonCharacters%20to%20%22abcdefghijklmnopqrstuvwxyz%22%0D%20%20%20%20%20%20%20%20set%20theSourceCharacters%20to%20%22ABCDEFGHIJKLMNOPQRSTUVWXYZ%22%0D%20%20%20%20else%0D%20%20%20%20%20%20%20%20return%20theText%0D%20%20%20%20end%20if%0D%20%20%20%20set%20theAlteredText%20to%20%22%22%0D%20%20%20%20repeat%20with%20aCharacter%20in%20theText%0D%20%20%20%20%20%20%20%20set%20theOffset%20to%20offset%20of%20aCharacter%20in%20theComparisonCharacters%0D%20%20%20%20%20%20%20%20if%20theOffset%20is%20not%200%20then%0D%20%20%20%20%20%20%20%20%20%20%20%20set%20theAlteredText%20to%20%28theAlteredText%20%26%20character%20theOffset%20of%20theSourceCharacters%29%20as%20string%0D%20%20%20%20%20%20%20%20else%0D%20%20%20%20%20%20%20%20%20%20%20%20set%20theAlteredText%20to%20%28theAlteredText%20%26%20aCharacter%29%20as%20string%0D%20%20%20%20%20%20%20%20end%20if%0D%20%20%20%20end%20repeat%0D%20%20%20%20return%20theAlteredText%0Dend%20changeCaseOfText%0D)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW2\"></a>\n**Listing 40-1**AppleScript: Example of an Automator service script that converts selected text to uppercase\n\n1. `on run {input, parameters}`\n2. ` set input to changeCaseOfText(input as string, \"upper\")`\n3. ` return input`\n4. `end run`\n6. `on changeCaseOfText(theText, theCaseToSwitchTo)`\n7. ` if theCaseToSwitchTo contains \"lower\" then`\n8. ` set theComparisonCharacters to \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"`\n9. ` set theSourceCharacters to \"abcdefghijklmnopqrstuvwxyz\"`\n10. ` else if theCaseToSwitchTo contains \"upper\" then`\n11. ` set theComparisonCharacters to \"abcdefghijklmnopqrstuvwxyz\"`\n12. ` set theSourceCharacters to \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"`\n13. ` else`\n14. ` return theText`\n15. ` end if`\n16. ` set theAlteredText to \"\"`\n17. ` repeat with aCharacter in theText`\n18. ` set theOffset to offset of aCharacter in theComparisonCharacters`\n19. ` if theOffset is not 0 then`\n20. ` set theAlteredText to (theAlteredText & character theOffset of theSourceCharacters) as string`\n21. ` else`\n22. ` set theAlteredText to (theAlteredText & aCharacter) as string`\n23. ` end if`\n24. ` end repeat`\n25. ` return theAlteredText`\n26. `end changeCaseOfText`\n\n**JAVASCRIPT**\n\n[Open in Script Editor](https://developer.apple.com/library/archive/mac-automation-scripting-guide/applescript:/com.apple.scripteditor?action=new&name=Convert%20Text%20to%20Uppercase&script=function%20run%28input%2C%20parameters%29%20%7B%0A%20%20%20%20var%20selectedText%20%3D%20input%5B0%5D%0A%20%20%20%20return%20selectedText.toUpperCase%28%29%0A%7D)\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW3\"></a>\n**Listing 40-2**JavaScript: Example of an Automator service script that converts selected text to uppercase\n\n1. `function run(input, parameters) {`\n2. ` var selectedText = input[0]`\n3. ` return selectedText.toUpperCase()`\n4. `}`\n\n<a id=\"//apple_ref/doc/uid/TP40016239-CH46-SW13\"></a>\n\n### Triggering Service Workflows\n\nSaved Automator service workflows automatically appear in services menus throughout the system at the appropriate time. For example, text processing workflows become available when you select text in an app. To run a service, select Application Name &gt; Services &gt; Service Workflow Name from the menu bar, or select Services &gt; Service Workflow Name from a contextual menu.\n",
  "binary": false,
  "source_url": "https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/MakeaSystem-WideService.html",
  "sha256": "4304da5a84a7c3b704402ec87fe3cbb313bf2ad946c2261d8fa099bae61d677e",
  "etag": null,
  "last_modified": null
}
